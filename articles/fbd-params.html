<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EvoPhylo">
<title>Analyzing FBD Parameters • EvoPhylo</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing FBD Parameters">
<meta property="og:description" content="EvoPhylo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EvoPhylo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_treatment.html">Theoretical background</a>
    <a class="dropdown-item" href="../articles/char-part.html">Character Partitioning</a>
    <a class="dropdown-item" href="../articles/rates-selection_MrBayes.html">Evolutionary Rates &amp; Selection Mode (Mr.Bayes)</a>
    <a class="dropdown-item" href="../articles/rates-selection_BEAST2.html">Evolutionary Rates &amp; Selection Mode (BEAST2)</a>
    <a class="dropdown-item" href="../articles/fbd-params.html">Analyzing FBD Parameters</a>
    <a class="dropdown-item" href="../articles/offset_handling.html">Analyzing Trees With Offsets</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tiago-simoes/EvoPhylo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="fbd-params_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="fbd-params_files/kePrint-0.0.1/kePrint.js"></script><link href="fbd-params_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Analyzing FBD Parameters</h1>
            
            <h4 data-toc-skip class="date">2022-11-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tiago-simoes/EvoPhylo/blob/HEAD/vignettes/fbd-params.Rmd" class="external-link"><code>vignettes/fbd-params.Rmd</code></a></small>
      <div class="d-none name"><code>fbd-params.Rmd</code></div>
    </div>

    
    
<p>This vignette explains how to extract, plot, and statistically test for differences among BD (Birth-Death) or FBD (fossilized birth-death) parameters (e.g., <em>net diversification</em>, <em>relative extinction (turnover)</em>, and <em>relative fossilization</em>) across the tree when using the Skyline BD or Skyline FBD tree models produced by the program <a href="https://nbisweden.github.io/MrBayes/" class="external-link">Mr. Bayes</a> or <a href="http://www.beast2.org/" class="external-link">BEAST2</a> (SA or BDSKY packages).</p>
<p>Load the <strong>EvoPhylo</strong> package</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tiago-simoes/EvoPhylo" class="external-link">EvoPhylo</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="fbd-parameters-statistics-and-plots-mr--bayes">FBD Parameters Statistics and Plots (Mr. Bayes)<a class="anchor" aria-label="anchor" href="#fbd-parameters-statistics-and-plots-mr--bayes"></a>
</h2>
<p>Below we demonstrate how to extract evolutionary rate summary statistics from each node from a Bayesian clock (time-calibrate) summary tree produced by Mr. Bayes, store them in a data frame, produce summary tables, and plots.</p>
<div class="section level3">
<h3 id="import-combined-log-file-from-all-runs-">1. Import combined log file from all runs.<a class="anchor" aria-label="anchor" href="#import-combined-log-file-from-all-runs-"></a>
</h3>
<p>This is produced by using <code><a href="../reference/combine_log.html">combine_log()</a></code>.The first argument passed to <code><a href="../reference/combine_log.html">combine_log()</a></code> should be a path to the folder containing the log files to be imported and combined.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Import all log (.p) files from all runs and combine them, with burn-in = 25% </span></span>
<span><span class="co">## and downsampling to 2.5k trees in each log file</span></span>
<span><span class="va">posterior3p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_log.html">combine_log</a></span><span class="op">(</span><span class="st">"LogFiles3p"</span>, burnin <span class="op">=</span> <span class="fl">0.25</span>, downsample <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Below, we use the posterior dataset <code>posterior3p</code> that accompanies <code>EvoPhylo</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">posterior3p</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Show first 5 lines of combined log file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">posterior3p</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>The posterior data must first be transformed from wide to long to be used with the functions described below; <code><a href="../reference/FBD_reshape.html">FBD_reshape()</a></code> accomplishes this.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reshape imported combined log file from wide to long with FBD_reshape</span></span>
<span><span class="va">posterior3p_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_reshape.html">FBD_reshape</a></span><span class="op">(</span><span class="va">posterior3p</span>, variables <span class="op">=</span> <span class="cn">NULL</span>, log.type <span class="op">=</span> <span class="st">"MrBayes"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarize-fbd-parameters-by-time-bin">2. Summarize FBD parameters by time bin<a class="anchor" aria-label="anchor" href="#summarize-fbd-parameters-by-time-bin"></a>
</h3>
<p>Summary statistics for each FBD parameter by time bin can be quickly summarized using <code><a href="../reference/FBD_summary.html">FBD_summary()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Summarize parameters by time bin and analysis</span></span>
<span><span class="va">t3.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_summary.html">FBD_summary</a></span><span class="op">(</span><span class="va">posterior3p_long</span><span class="op">)</span></span>
<span><span class="va">t3.1</span></span></code></pre></div>
<table class="table table table-striped" style="font-size: 15px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
FBD parameters by time bin
</caption>
<thead><tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:left;">
Time_bin
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
Q1
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
Q3
</th>
<th style="text-align:right;">
max
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.97
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.72
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.54
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.99
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Export the table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">t3.1</span>, file <span class="op">=</span> <span class="st">"FBD_summary.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-the-distribution-of-each-fbd-parameter">3. Plot the distribution of each FBD parameter<a class="anchor" aria-label="anchor" href="#plot-the-distribution-of-each-fbd-parameter"></a>
</h3>
<p>Each of (or all) the FBD parameter distributions can be plotted by time bin using various plotting alternatives with <code><a href="../reference/FBD_dens_plot.html">FBD_dens_plot()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot distribution of the desired FBD parameter by time bin with </span></span>
<span><span class="co">## kernel density plot</span></span>
<span><span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior3p_long</span>, parameter <span class="op">=</span> <span class="st">"net_speciation"</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"density"</span>, stack <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="fbd-params_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot distribution of the desired FBD parameter by time bin with </span></span>
<span><span class="co">## stacked kernel density plot</span></span>
<span><span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior3p_long</span>, parameter <span class="op">=</span> <span class="st">"net_speciation"</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"density"</span>, stack <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="fbd-params_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot distribution of the desired FBD parameter by time bin with </span></span>
<span><span class="co">## a violin plot</span></span>
<span><span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior3p_long</span>, parameter <span class="op">=</span> <span class="st">"net_speciation"</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"violin"</span>, stack <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fbd-params_files/figure-html/unnamed-chunk-11-1.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot distribution of all FBD parameter by time bin with a violin plot</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior3p_long</span>, parameter <span class="op">=</span> <span class="st">"net_speciation"</span>,</span>
<span>                    type <span class="op">=</span> <span class="st">"violin"</span>, stack <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior3p_long</span>, parameter <span class="op">=</span> <span class="st">"relative_extinction"</span>,</span>
<span>                    type <span class="op">=</span> <span class="st">"violin"</span>, stack <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"cyan3"</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior3p_long</span>, parameter <span class="op">=</span> <span class="st">"relative_fossilization"</span>,</span>
<span>                    type <span class="op">=</span> <span class="st">"violin"</span>, stack <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"green3"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="fbd-params_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Save your plot to your working directory as a PDF</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"Plot_regs.pdf"</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="test-for-assumptions">4. Test for assumptions<a class="anchor" aria-label="anchor" href="#test-for-assumptions"></a>
</h3>
<p>In this step, users can perform tests for normality and homoscedasticity in data distribution for each of the FBD parameters under consideration. The output will determine whether parametric or nonparametric tests will be performed subsequently.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##### Tests for normality and homoscedasticity for each FBD parameter for all time bins</span></span>
<span><span class="va">t3.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_tests1.html">FBD_tests1</a></span><span class="op">(</span><span class="va">posterior3p_long</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Export the output table for all tests</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">t3.2</span>, file <span class="op">=</span> <span class="st">"FBD_Tests1_Assum.csv"</span><span class="op">)</span></span></code></pre></div>
<p>The results of the Shapiro-Wilk normality test for each parameter can be output as seperate tables or as a single combined table.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Output as separate tables </span></span>
<span><span class="va">t3.2</span><span class="op">$</span><span class="va">shapiro</span></span></code></pre></div>
<table class="table kable_wrapper table table-striped" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Shapiro-Wilk normality test
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
statistic
</th>
<th style="text-align:center;">
p-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Time bin 1
</td>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
0.9917
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Time bin 2
</td>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
0.9385
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Time bin 3
</td>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
0.9227
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Time bin 4
</td>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
0.9898
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Overall
</td>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
0.9568
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
0.9874
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
statistic
</th>
<th style="text-align:center;">
p-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Time bin 1
</td>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
0.8927
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Time bin 2
</td>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
0.9247
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Time bin 3
</td>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
0.8044
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Time bin 4
</td>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
0.3775
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Overall
</td>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
0.7036
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
0.8238
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
statistic
</th>
<th style="text-align:center;">
p-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Time bin 1
</td>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
0.5764
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Time bin 2
</td>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
0.8853
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Time bin 3
</td>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
0.6210
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Time bin 4
</td>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
0.4637
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Overall
</td>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
0.5473
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
0.5531
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># OR as single merged table</span></span>
<span><span class="va">t3.2</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">net_speciation</span><span class="op">$</span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">t3.2</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">net_speciation</span><span class="op">)</span>  </span>
<span><span class="va">t3.2</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">relative_extinction</span><span class="op">$</span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">t3.2</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">relative_extinction</span><span class="op">)</span>  </span>
<span><span class="va">t3.2</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">relative_fossilization</span><span class="op">$</span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">t3.2</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">relative_fossilization</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">k1all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">t3.2</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">net_speciation</span>,</span>
<span>               <span class="va">t3.2</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">relative_extinction</span>,</span>
<span>               <span class="va">t3.2</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">relative_fossilization</span>,</span>
<span>               make.row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k1all</span></span></code></pre></div>
<table class="table table table-striped" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Shapiro-Wilk normality test
</caption>
<thead><tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
bin
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:right;">
0.9917
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 1
</td>
</tr>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:right;">
0.9385
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 2
</td>
</tr>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:right;">
0.9227
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 3
</td>
</tr>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:right;">
0.9898
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 4
</td>
</tr>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:right;">
0.9568
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Overall
</td>
</tr>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:right;">
0.9874
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Residuals
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:right;">
0.8927
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 1
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:right;">
0.9247
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 2
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:right;">
0.8044
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 3
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:right;">
0.3775
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 4
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:right;">
0.7036
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Overall
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:right;">
0.8238
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Residuals
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:right;">
0.5764
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 1
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:right;">
0.8853
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 2
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:right;">
0.6210
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 3
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:right;">
0.4637
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Time bin 4
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:right;">
0.5473
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Overall
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:right;">
0.5531
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Residuals
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Bartlett's test for homogeneity of variance </span></span>
<span><span class="va">t3.2</span><span class="op">$</span><span class="va">bartlett</span></span></code></pre></div>
<table class="table table table-striped" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Bartlett’s test
</caption>
<thead><tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:right;">
3815.464
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:right;">
18159.213
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:right;">
25654.975
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Fligner-Killeen test for homogeneity of variance </span></span>
<span><span class="va">t3.2</span><span class="op">$</span><span class="va">fligner</span></span></code></pre></div>
<table class="table table table-striped" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Fligner-Killeen test
</caption>
<thead><tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
net_speciation
</td>
<td style="text-align:right;">
3748.140
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_extinction
</td>
<td style="text-align:right;">
12599.843
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
relative_fossilization
</td>
<td style="text-align:right;">
4808.545
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Deviations from normality can be displayed graphically using <code><a href="../reference/FBD_normality_plot.html">FBD_normality_plot()</a></code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Visualize deviations from normality and similarity of variances</span></span>
<span><span class="fu"><a href="../reference/FBD_normality_plot.html">FBD_normality_plot</a></span><span class="op">(</span><span class="va">posterior3p_long</span><span class="op">)</span></span></code></pre></div>
<p><img src="fbd-params_files/figure-html/unnamed-chunk-25-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Save your plot to your working directory as a PDF</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"Plot_normTests.pdf"</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="test-for-significant-fbd-shifts-between-time-bins">5. Test for significant FBD shifts between time bins<a class="anchor" aria-label="anchor" href="#test-for-significant-fbd-shifts-between-time-bins"></a>
</h3>
<p>Significant shifts in FBD parameters across time bins can be easily tested using parametric (Student’s t-test) and nonparametric (Mann-Whitney test) pairwise comparisons with <code><a href="../reference/FBD_tests2.html">FBD_tests2()</a></code>. Both are automatically calculated and the preferred pairwise comparison will be chosen by the user depending on the results of the assumption tests <strong>step #4</strong> (above).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##### Test for significant differences between each time bin for each FBD parameter</span></span>
<span><span class="va">t3.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_tests2.html">FBD_tests2</a></span><span class="op">(</span><span class="va">posterior3p_long</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Export the output table for all tests</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">t3.3</span>, file <span class="op">=</span> <span class="st">"FBD_Tests2_Sign.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Pairwise t-tests</span></span>
<span><span class="co"># Output as separate tables </span></span>
<span><span class="va">t3.3</span><span class="op">$</span><span class="va">t_tests</span></span></code></pre></div>
<table class="table kable_wrapper table table-striped" style="font-size: 10px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Significant tests
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
Time_bin1
</th>
<th style="text-align:center;">
Time_bin2
</th>
<th style="text-align:center;">
n1
</th>
<th style="text-align:center;">
n2
</th>
<th style="text-align:center;">
p-value
</th>
<th style="text-align:center;">
p-value adj
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
Time_bin1
</th>
<th style="text-align:center;">
Time_bin2
</th>
<th style="text-align:center;">
n1
</th>
<th style="text-align:center;">
n2
</th>
<th style="text-align:center;">
p-value
</th>
<th style="text-align:center;">
p-value adj
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
Time_bin1
</th>
<th style="text-align:center;">
Time_bin2
</th>
<th style="text-align:center;">
n1
</th>
<th style="text-align:center;">
n2
</th>
<th style="text-align:center;">
p-value
</th>
<th style="text-align:center;">
p-value adj
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># OR as single merged table</span></span>
<span><span class="va">k3.3a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">t3.3</span><span class="op">$</span><span class="va">t_tests</span><span class="op">$</span><span class="va">net_speciation</span>,</span>
<span>               <span class="va">t3.3</span><span class="op">$</span><span class="va">t_tests</span><span class="op">$</span><span class="va">relative_extinction</span>,</span>
<span>               <span class="va">t3.3</span><span class="op">$</span><span class="va">t_tests</span><span class="op">$</span><span class="va">relative_fossilization</span>,</span>
<span>               make.row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k3.3a</span></span></code></pre></div>
<table class="table table table-striped" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Pairwise t-tests
</caption>
<thead><tr>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
Time_bin1
</th>
<th style="text-align:center;">
Time_bin2
</th>
<th style="text-align:center;">
n1
</th>
<th style="text-align:center;">
n2
</th>
<th style="text-align:center;">
p-value
</th>
<th style="text-align:center;">
p-value adj
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Mann-Whitney tests (use if Tests in step #4 fail assumptions)</span></span>
<span><span class="co"># Output as separate tables </span></span>
<span><span class="va">t3.3</span><span class="op">$</span><span class="va">mwu_tests</span></span></code></pre></div>
<table class="table kable_wrapper table table-striped" style="font-size: 10px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Mann-Whitney tests
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
Time_bin1
</th>
<th style="text-align:center;">
Time_bin2
</th>
<th style="text-align:center;">
n1
</th>
<th style="text-align:center;">
n2
</th>
<th style="text-align:center;">
p-value
</th>
<th style="text-align:center;">
p-value adj
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
Time_bin1
</th>
<th style="text-align:center;">
Time_bin2
</th>
<th style="text-align:center;">
n1
</th>
<th style="text-align:center;">
n2
</th>
<th style="text-align:center;">
p-value
</th>
<th style="text-align:center;">
p-value adj
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
Time_bin1
</th>
<th style="text-align:center;">
Time_bin2
</th>
<th style="text-align:center;">
n1
</th>
<th style="text-align:center;">
n2
</th>
<th style="text-align:center;">
p-value
</th>
<th style="text-align:center;">
p-value adj
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># OR as single merged table</span></span>
<span><span class="va">k3.3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">t3.3</span><span class="op">$</span><span class="va">mwu_tests</span><span class="op">$</span><span class="va">net_speciation</span>,</span>
<span>               <span class="va">t3.3</span><span class="op">$</span><span class="va">mwu_tests</span><span class="op">$</span><span class="va">relative_extinction</span>,</span>
<span>               <span class="va">t3.3</span><span class="op">$</span><span class="va">mwu_tests</span><span class="op">$</span><span class="va">relative_fossilization</span>,</span>
<span>               make.row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k3.3b</span></span></code></pre></div>
<table class="table table table-striped" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Mann-Whitney tests
</caption>
<thead><tr>
<th style="text-align:center;">
parameter
</th>
<th style="text-align:center;">
Time_bin1
</th>
<th style="text-align:center;">
Time_bin2
</th>
<th style="text-align:center;">
n1
</th>
<th style="text-align:center;">
n2
</th>
<th style="text-align:center;">
p-value
</th>
<th style="text-align:center;">
p-value adj
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
net_speciation
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_extinction
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
relative_fossilization
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<p> <br>
 <br>
 </p>
</div>
</div>
<div class="section level2">
<h2 id="fbd-parameters-statistics-and-plots-beast2">FBD Parameters Statistics and Plots (BEAST2)<a class="anchor" aria-label="anchor" href="#fbd-parameters-statistics-and-plots-beast2"></a>
</h2>
<div class="section level3">
<h3 id="import-combined-log-file-from-all-runs--1">1. Import combined log file from all runs.<a class="anchor" aria-label="anchor" href="#import-combined-log-file-from-all-runs--1"></a>
</h3>
<p>The combined posterior log file from <a href="https://www.beast2.org/beagle-beast-2-in-cluster/index.html" class="external-link">BEAST2</a> is outputted by <strong>LogCombiner</strong> from their software package. Our own function to combined log files <code>combine_log</code> is intended to work with Mr. Bayes posterior files only.</p>
<p>Below, we use the posterior dataset “Penguins_log.log” that accompanies <code>EvoPhylo</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Penguins_log.log"</span>, package <span class="op">=</span> <span class="st">"EvoPhylo"</span><span class="op">)</span></span>
<span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">posterior</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Show first 10 lines of combined log file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">posterior</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>The posterior data must first be transformed from wide to long to be used with the functions described below; <code><a href="../reference/FBD_reshape.html">FBD_reshape()</a></code> accomplishes this.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reshape imported combined log file from wide to long with FBD_reshape</span></span>
<span><span class="va">posterior_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_reshape.html">FBD_reshape</a></span><span class="op">(</span><span class="va">posterior</span>, variables <span class="op">=</span> <span class="cn">NULL</span>, log.type <span class="op">=</span> <span class="st">"BEAST2"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarize-fbd-parameters-by-time-bin-1">2. Summarize FBD parameters by time bin<a class="anchor" aria-label="anchor" href="#summarize-fbd-parameters-by-time-bin-1"></a>
</h3>
<p>Summary statistics for each FBD parameter by time bin can be quickly summarized using <code><a href="../reference/FBD_summary.html">FBD_summary()</a></code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Summarize parameters by time bin and analysis</span></span>
<span><span class="va">t3.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_summary.html">FBD_summary</a></span><span class="op">(</span><span class="va">posterior_long</span><span class="op">)</span></span>
<span><span class="va">t3.1</span></span></code></pre></div>
<table class="table table table-striped" style="font-size: 15px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
FBD parameters by time bin
</caption>
<thead><tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:left;">
Time_bin
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
Q1
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
Q3
</th>
<th style="text-align:right;">
max
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
diversificationRateFBD
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
556
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
turnoverFBD
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
556
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
samplingProportionFBD
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
556
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.74
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Export the table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">t3.1</span>, file <span class="op">=</span> <span class="st">"FBD_summary_BEAST2.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-the-distribution-of-each-fbd-parameter-1">3. Plot the distribution of each FBD parameter<a class="anchor" aria-label="anchor" href="#plot-the-distribution-of-each-fbd-parameter-1"></a>
</h3>
<p>Each of (or all) the FBD parameter distributions can be plotted by time bin using various plotting alternatives with <code><a href="../reference/FBD_dens_plot.html">FBD_dens_plot()</a></code>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot distribution of the desired FBD parameter by time bin with </span></span>
<span><span class="co">## kernel density plot</span></span>
<span><span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior_long</span>, parameter <span class="op">=</span> <span class="st">"diversificationRateFBD"</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"density"</span>, stack <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="fbd-params_files/figure-html/unnamed-chunk-43-1.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot distribution of the desired FBD parameter by time bin with </span></span>
<span><span class="co">## a violin plot</span></span>
<span><span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior_long</span>, parameter <span class="op">=</span> <span class="st">"diversificationRateFBD"</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"violin"</span>, stack <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fbd-params_files/figure-html/unnamed-chunk-44-1.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot distribution of all FBD parameter by time bin with a violin plot</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior_long</span>, parameter <span class="op">=</span> <span class="st">"diversificationRateFBD"</span>,</span>
<span>                    type <span class="op">=</span> <span class="st">"violin"</span>, stack <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior_long</span>, parameter <span class="op">=</span> <span class="st">"turnoverFBD"</span>,</span>
<span>                    type <span class="op">=</span> <span class="st">"violin"</span>, stack <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"cyan3"</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FBD_dens_plot.html">FBD_dens_plot</a></span><span class="op">(</span><span class="va">posterior_long</span>, parameter <span class="op">=</span> <span class="st">"samplingProportionFBD"</span>,</span>
<span>                    type <span class="op">=</span> <span class="st">"violin"</span>, stack <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"green3"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="fbd-params_files/figure-html/unnamed-chunk-45-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Save your plot to your working directory as a PDF</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"Plot_regs.pdf"</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tiago Simoes, Noah Greifer, Joelle Barido-Sottani, Stephanie Pierce.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
