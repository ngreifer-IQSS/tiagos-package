<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EvoPhylo">
<title>Character Partitioning • EvoPhylo</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Character Partitioning">
<meta property="og:description" content="EvoPhylo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EvoPhylo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_treatment.html">Theoretical background</a>
    <a class="dropdown-item" href="../articles/char-part.html">Character Partitioning</a>
    <a class="dropdown-item" href="../articles/rates-selection_MrBayes.html">Evolutionary Rates &amp; Selection Mode (Mr.Bayes)</a>
    <a class="dropdown-item" href="../articles/rates-selection_BEAST2.html">Evolutionary Rates &amp; Selection Mode (BEAST2)</a>
    <a class="dropdown-item" href="../articles/fbd-params.html">Analyzing FBD Parameters</a>
    <a class="dropdown-item" href="../articles/offset_handling.html">Analyzing Trees With Offsets</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tiago-simoes/EvoPhylo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="char-part_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Character Partitioning</h1>
            
            <h4 data-toc-skip class="date">2022-11-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tiago-simoes/EvoPhylo/blob/HEAD/vignettes/char-part.Rmd" class="external-link"><code>vignettes/char-part.Rmd</code></a></small>
      <div class="d-none name"><code>char-part.Rmd</code></div>
    </div>

    
    
<p>This vignette explains how to conduct automated morphological character partitioning as a pre-processing step for clock (time-calibrated) Bayesian phylogenetic analysis of morphological data, as introduced by <span class="citation">Simões and Pierce (<a href="#ref-sim%C3%B5es2021" role="doc-biblioref">2021</a>)</span>.</p>
<div class="section level2">
<h2 id="character-partitioning-case-1">Character Partitioning (Case 1)<a class="anchor" aria-label="anchor" href="#character-partitioning-case-1"></a>
</h2>
<p>Load the <strong>EvoPhylo</strong> package</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tiago-simoes/EvoPhylo" class="external-link">EvoPhylo</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="generate-distance-matrix">1. Generate distance matrix<a class="anchor" aria-label="anchor" href="#generate-distance-matrix"></a>
</h3>
<p>Generate a Gower distance matrix with <code><a href="../reference/get_gower_dist.html">get_gower_dist()</a></code> by supplying the file path of a .nex file containing a character data matrix:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load a character data matrix from your local directory to produce a Gower distance matrix</span></span>
<span><span class="va">dist_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_gower_dist.html">get_gower_dist</a></span><span class="op">(</span><span class="st">"DataMatrix.nex"</span>, numeric <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## OR</span></span>
<span><span class="co">#Load an example data matrix 'DataMatrix.nex' that accompanies `EvoPhylo`.</span></span>
<span><span class="va">DataMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"DataMatrix.nex"</span>, package <span class="op">=</span> <span class="st">"EvoPhylo"</span><span class="op">)</span></span>
<span><span class="va">dist_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_gower_dist.html">get_gower_dist</a></span><span class="op">(</span><span class="va">DataMatrix</span>, numeric <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Below, we use the example data matrix <code>characters</code> that accompanies <code>EvoPhylo</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">characters</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_gower_dist.html">get_gower_dist</a></span><span class="op">(</span><span class="va">characters</span>, numeric <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimate-the-optimal-number-of-partitions">2. Estimate the optimal number of partitions<a class="anchor" aria-label="anchor" href="#estimate-the-optimal-number-of-partitions"></a>
</h3>
<p>The optimal number of partitions (clusters) will be first determined using partitioning around medoids (PAM) with Silhouette widths index (Si) using <code><a href="../reference/get_sil_widths.html">get_sil_widths()</a></code>. The latter will estimate the quality of each PAM cluster proposal relative to other potential clusters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Estimate and plot number of cluster against silhouette width</span></span>
<span><span class="va">sw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_sil_widths.html">get_sil_widths</a></span><span class="op">(</span><span class="va">dist_matrix</span>, max.k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sw</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="char-part_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>Decide on number of clusters based on plot; here, <span class="math inline">\(k = 3\)</span> partitions appears optimal.</p>
</div>
<div class="section level3">
<h3 id="simple-workflow">3. Simple Workflow<a class="anchor" aria-label="anchor" href="#simple-workflow"></a>
</h3>
<p>3.1. Analyze clusters with PAM under chosen <span class="math inline">\(k\)</span> value (from Si) with <code><a href="../reference/make_clusters.html">make_clusters()</a></code>.</p>
<p>3.2. Produce simple cluster graph</p>
<p>3.3. Export clusters/partitions to Nexus file with <code><a href="../reference/cluster_to_nexus.html">cluster_to_nexus()</a></code> or <code><a href="../reference/write_partitioned_alignments.html">write_partitioned_alignments()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Generate and vizualize clusters with PAM under chosen k value. </span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_clusters.html">make_clusters</a></span><span class="op">(</span><span class="va">dist_matrix</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span></span></code></pre></div>
<p><img src="char-part_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Write clusters to Nexus file for Mr. Bayes</span></span>
<span><span class="fu"><a href="../reference/cluster_to_nexus.html">cluster_to_nexus</a></span><span class="op">(</span><span class="va">clusters</span>, file <span class="op">=</span> <span class="st">"Clusters_MB.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write partitioned alignments to separate Nexus files for BEAUTi</span></span>
<span><span class="co"># Make reference to your original character data matrix in your local directory</span></span>
<span><span class="fu"><a href="../reference/write_partitioned_alignments.html">write_partitioned_alignments</a></span><span class="op">(</span><span class="st">"DataMatrix.nex"</span>, <span class="va">clusters</span>, file <span class="op">=</span> <span class="st">"Clusters_BEAUTi.nex"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="complete-workflow">4. Complete Workflow<a class="anchor" aria-label="anchor" href="#complete-workflow"></a>
</h3>
<p>4.1. Analyze clusters with PAM under chosen <span class="math inline">\(k\)</span> value (from Si) with <code><a href="../reference/make_clusters.html">make_clusters()</a></code>.</p>
<p>4.2. Produce a graphic clustering (tSNEs), coloring data points according to PAM clusters, to independently verify PAM clustering. This is set with the <code>tsne</code> argument within <code><a href="../reference/make_clusters.html">make_clusters()</a></code>.</p>
<p>4.3. Export clusters/partitions to Nexus file with <code><a href="../reference/cluster_to_nexus.html">cluster_to_nexus()</a></code>. This can be copied and pasted into the <a href="https://nbisweden.github.io/MrBayes/" class="external-link">Mr. Bayes</a> command block. Alternatively, write the partitioned alignments as separate Nexus files using <code><a href="../reference/write_partitioned_alignments.html">write_partitioned_alignments()</a></code>. This will allow you to import the partitions separately into BEAUti for analyses with <a href="https://www.beast2.org/" class="external-link">BEAST2</a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#User may also generate clusters with PAM and produce a graphic clustering (tSNEs)</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_clusters.html">make_clusters</a></span><span class="op">(</span><span class="va">dist_matrix</span>, k <span class="op">=</span> <span class="fl">3</span>, tsne <span class="op">=</span> <span class="cn">TRUE</span>, tsne_dim <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">clusters</span>, nrow <span class="op">=</span> <span class="fl">2</span>, max.overlaps <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="char-part_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Write clusters to Nexus file for Mr. Bayes</span></span>
<span><span class="fu"><a href="../reference/cluster_to_nexus.html">cluster_to_nexus</a></span><span class="op">(</span><span class="va">clusters</span>, file <span class="op">=</span> <span class="st">"Clusters_MB.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write partitioned alignments to separate Nexus files for BEAUTi</span></span>
<span><span class="co"># Make reference to your original character data matrix in your local directory</span></span>
<span><span class="fu"><a href="../reference/write_partitioned_alignments.html">write_partitioned_alignments</a></span><span class="op">(</span><span class="st">"DataMatrix.nex"</span>, <span class="va">clusters</span>, file <span class="op">=</span> <span class="st">"Clusters_BEAUTi.nex"</span><span class="op">)</span></span></code></pre></div>
<p> <br>
 <br>
 </p>
</div>
</div>
<div class="section level2">
<h2 id="character-partitioning-case-2">Character Partitioning (Case 2)<a class="anchor" aria-label="anchor" href="#character-partitioning-case-2"></a>
</h2>
<p>Here is an additional example of how to conduct automated morphological character partitioning. In this example, we utilize a combined evidence dataset (morphological and molecular data) of fossil and extant penguins from <span class="citation">Ksepka et al. (<a href="#ref-ksepka2012" role="doc-biblioref">2012</a>)</span>, following similar modifications to this dataset as used in <span class="citation">Gavryushkina et al. (<a href="#ref-gavryushkina2017" role="doc-biblioref">2017</a>)</span> (removing all invariant characters from the dataset and all non-penguin taxa), resulting in 55 taxa and 201 characters for the morphological partition. A key feature of this dataset is the high amount of missing data in the fossil species. Therefore, it is recommended in such cases to reduce the number of observations with missing data (e.g. more than 30% of missing data, <span class="citation">Ciampaglio, Kemp, and McShea (<a href="#ref-ciampaglio2001" role="doc-biblioref">2001</a>)</span>). In this case, all fossils have more than 30% of missing data, and so only data from extant taxa were used to calculate character partitions.</p>
<div class="section level3">
<h3 id="generate-distance-matrix-1">1. Generate distance matrix<a class="anchor" aria-label="anchor" href="#generate-distance-matrix-1"></a>
</h3>
<p>Generate a Gower distance matrix with <code><a href="../reference/get_gower_dist.html">get_gower_dist()</a></code> by supplying the file path of a .nex file containing a character data matrix:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load a character data matrix from your local directory to produce a Gower distance matrix</span></span>
<span><span class="va">dist_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_gower_dist.html">get_gower_dist</a></span><span class="op">(</span><span class="st">"Penguins_Morpho(VarCh)_Extant.nex"</span>, numeric <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Or, for this example simply load the data matrix ’Penguins_Morpho(VarCh)_Extant.nex’ that accompanies <code>EvoPhylo</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DataMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Penguins_Morpho(VarCh)_Extant.nex"</span>, package <span class="op">=</span> <span class="st">"EvoPhylo"</span><span class="op">)</span></span>
<span><span class="va">dist_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_gower_dist.html">get_gower_dist</a></span><span class="op">(</span><span class="va">DataMatrix</span>, numeric <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimate-the-optimal-number-of-partitions-1">2. Estimate the optimal number of partitions<a class="anchor" aria-label="anchor" href="#estimate-the-optimal-number-of-partitions-1"></a>
</h3>
<p>The optimal number of partitions (clusters) will be first determined using partitioning around medoids (PAM) with Silhouette widths index (Si) using <code><a href="../reference/get_sil_widths.html">get_sil_widths()</a></code>. The latter will estimate the quality of each PAM cluster proposal relative to other potential clusters.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Estimate and plot number of cluster against silhouette width</span></span>
<span><span class="va">sw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_sil_widths.html">get_sil_widths</a></span><span class="op">(</span><span class="va">dist_matrix</span>, max.k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sw</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="char-part_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>Decide on number of clusters based on plot; here, <span class="math inline">\(k = 3\)</span> partitions appears optimal, Firstly followed by five partitions. In such cases, we encourage users to explore both number of partitions as the suboptimal partitioning (five) is close to the optimal number suggested (three). Deciding upon the final partitioning scheme shall be based on which number of partitions provides the best agreements between the first (PAM) and second (tSNEs) tests, or agreement with external evidence (anatomical or developmental subdivisions). For simplicity, here we explore only the option with three partitions.</p>
</div>
<div class="section level3">
<h3 id="complete-workflow-1">3. Complete Workflow<a class="anchor" aria-label="anchor" href="#complete-workflow-1"></a>
</h3>
<p>3.1. Analyze clusters with PAM under chosen <span class="math inline">\(k\)</span> value (from Si) with <code><a href="../reference/make_clusters.html">make_clusters()</a></code>.</p>
<p>3.2. Produce a graphic clustering (tSNEs), coloring data points according to PAM clusters, to independently verify PAM clustering. This is set with the <code>tsne</code> argument within <code><a href="../reference/make_clusters.html">make_clusters()</a></code>.</p>
<p>3.3. In this example we will analyze this dataset with BEAST2, so we will export the partitioned alignments as separate Nexus files using <code><a href="../reference/write_partitioned_alignments.html">write_partitioned_alignments()</a></code>. This will allow you to import the partitions separately into BEAUti for analyses with <a href="https://www.beast2.org/" class="external-link">BEAST2</a>. Remember to indicate the name of the full data matrix file to be partitioned (including all extant and fossil species in this case). The file name chosen (“Penguins_Morpho_3p.nex”) will be automatically appended with “…part<partitionnumber>”, which will also be important for recognizing the output from separate morphological partitions in subsequent steps in post processing.</partitionnumber></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#User may also generate clusters with PAM and produce a graphic clustering (tSNEs)</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_clusters.html">make_clusters</a></span><span class="op">(</span><span class="va">dist_matrix</span>, k <span class="op">=</span> <span class="fl">3</span>, tsne <span class="op">=</span> <span class="cn">TRUE</span>, tsne_dim <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">clusters</span>, nrow <span class="op">=</span> <span class="fl">2</span>, max.overlaps <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="char-part_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Write partitioned alignments to separate Nexus files for BEAUTi</span></span>
<span><span class="co"># Make reference to your original character data matrix in your local directory</span></span>
<span><span class="fu"><a href="../reference/write_partitioned_alignments.html">write_partitioned_alignments</a></span><span class="op">(</span><span class="st">"Penguins_Morpho(VarCha).nex"</span>, <span class="va">clusters</span>, file <span class="op">=</span> <span class="st">"Penguins_Morpho_3p.nex"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-ciampaglio2001">
<p>Ciampaglio, Charles N, Matthieu Kemp, and Daniel W McShea. 2001. “Detecting Changes in Morphospace Occupation Patterns in the Fossil Record: Characterization and Analysis of Measures of Disparity.” <em>Paleobiology</em> 27 (4): 695–715.</p>
</div>
<div id="ref-gavryushkina2017">
<p>Gavryushkina, Alexandra, Tracy A Heath, Daniel T Ksepka, Tanja Stadler, David Welch, and Alexei J Drummond. 2017. “Bayesian Total-Evidence Dating Reveals the Recent Crown Radiation of Penguins.” <em>Systematic Biology</em> 66 (1): 57–73.</p>
</div>
<div id="ref-ksepka2012">
<p>Ksepka, Daniel T, R Ewan Fordyce, Tatsuro Ando, and Craig M Jones. 2012. “New Fossil Penguins (Aves, Sphenisciformes) from the Oligocene of New Zealand Reveal the Skeletal Plan of Stem Penguins.” <em>Journal of Vertebrate Paleontology</em> 32 (2): 235–54.</p>
</div>
<div id="ref-simões2021">
<p>Simões, Tiago R., and Stephanie E. Pierce. 2021. “Sustained High Rates of Morphological Evolution During the Rise of Tetrapods.” <em>Nature Ecology &amp; Evolution</em> 5 (10): 1403–14. <a href="https://doi.org/10.1038/s41559-021-01532-x" class="external-link">https://doi.org/10.1038/s41559-021-01532-x</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tiago Simoes, Noah Greifer, Joelle Barido-Sottani, Stephanie Pierce.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
