<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Converts FBD posterior parameter table, such as those imported using combine_log, from wide to long format."><title>Convert an FBD posterior parameter table from wide to long format — FBD_reshape • EvoPhylo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Convert an FBD posterior parameter table from wide to long format — FBD_reshape"><meta property="og:description" content="Converts FBD posterior parameter table, such as those imported using combine_log, from wide to long format."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EvoPhylo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/theory.html">Theoretical background</a>
    <a class="dropdown-item" href="../articles/char-part.html">Character Partitioning</a>
    <a class="dropdown-item" href="../articles/rates-selection.html">Evolutionary Rates &amp; Selection Mode</a>
    <a class="dropdown-item" href="../articles/fbd-params.html">Analyzing FBD Parameters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tiago-simoes/EvoPhylo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Convert an FBD posterior parameter table from wide to long format</h1>
      
      <div class="d-none name"><code>FBD_reshape.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Converts FBD posterior parameter table, such as those imported using <code><a href="combine_log.html">combine_log</a></code>, from wide to long format.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">FBD_reshape</span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>posterior</dt>
<dd><p>Single posterior parameter sample dataset with skyline FBD parameters produced with <code><a href="combine_log.html">combine_log</a></code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The posterior parameters log files produced by Bayesian evolutionary analyses using skyline birth-death tree models, including the skyline FBD model, result into two or more estimates for each FBD parameter (e.g., "net diversification", "relative extinction", and "relative fossilization"), one for each time bin. This function will convert parameters (.p) log files with skyline FBD parameters from wide to long format, with one row per generation per time bin and a new column "Time_bin" containing the respective time bins as a factor. The long format is necessary for downstream analyses using <code><a href="FBD_summary.html">FBD_summary</a></code>, <code><a href="FBD_dens_plot.html">FBD_dens_plot</a></code>, <code><a href="FBD_normality_plot.html">FBD_normality_plot</a></code>, <code><a href="FBD_tests1.html">FBD_tests1</a></code>, or <code><a href="FBD_tests2.html">FBD_tests2</a></code>, as similarly done by <code><a href="clock_reshape.html">clock_reshape</a></code> for clock rate tables.</p>
<p>The "posterior" data frame can be obtained by combining several output log files (.p files) from Mr. Bayes using <code><a href="combine_log.html">combine_log</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame of posterior parameter estimates containing a single "Time_bin" column and one column for each FBD parameter value (e.g., "net_speciation", "relative extinction", and "relative fossilization").</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="../articles/fbd-params.html">vignette("fbd-params")</a></code> for the use of this function as part of an analysis pipeline.</p>
<p><code><a href="combine_log.html">combine_log</a></code>, <code><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># See vignette("fbd-params") for how to use this</span></span>
<span class="r-in"><span class="co"># function as part of an analysis pipeline</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"posterior3p"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">posterior3p</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Gen       LnL      LnPr  TH.all.   TL.all. prop_ancfossil.all.   sigma.1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 8750000 -1449.425 -143.1907 5.271118 11.969460                   0 0.07660715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 8761000 -1458.367 -174.9627 4.775064 11.070210                   0 0.05850396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 8771000 -1449.445 -163.9216 5.927716 12.628460                   0 0.05182430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 8782000 -1453.218 -153.2030 4.451376  9.931809                   0 0.14644520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 8792000 -1461.906 -132.1172 5.095504 11.083810                   0 0.14143120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 8803000 -1452.809 -129.3066 4.715021 10.481830                   0 0.10207230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sigma.2.  sigma.3.      m.1.     m.2.     m.3. net_speciation_1.all.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.33351500 0.8523453 0.3695799 1.544579 1.362332            0.04987983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.06463618 0.1380557 0.5083868 1.495777 1.108471            0.04675159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.67980130 0.7776142 0.4275609 1.569911 1.144364            0.01064803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.65005980 0.2999867 0.6445027 1.329942 1.148377            0.07373453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.52745340 1.3928490 0.4993570 1.368074 1.445410            0.04990040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1.31535200 0.7405540 0.4835195 1.359665 1.508596            0.03950198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   net_speciation_2.all. net_speciation_3.all. net_speciation_4.all.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           0.030036060           0.009395822            0.02637372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           0.013372350           0.021293800            0.02126325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           0.010895640           0.017047410            0.04032594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           0.007208267           0.021414940            0.03326603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           0.006333419           0.019637100            0.01893420</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           0.005410397           0.026179850            0.02002429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   relative_extinction_1.all. relative_extinction_2.all.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                  0.6785586                  0.9373640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                  0.9174022                  0.9838011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                  0.9677827                  0.9857446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                  0.8976315                  0.9883790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                  0.7887825                  0.9883790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                  0.8675209                  0.9851012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   relative_extinction_3.all. relative_extinction_4.all.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                  0.9555714                0.002227504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                  0.5125231                0.028959450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                  0.9032853                0.012431660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                  0.9464226                0.011271430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                  0.9658652                0.008529459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                  0.9268501                0.026359290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   relative_fossilization_1.all. relative_fossilization_2.all.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                   0.055629950                    0.03741083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                   0.006523517                    0.02198622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                   0.010535440                    0.02155796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                   0.001264865                    0.02106140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                   0.036796000                    0.03160199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                   0.006094768                    0.04703950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   relative_fossilization_3.all. relative_fossilization_4.all. tk02var.1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                   0.020690570                  0.0253022700  0.3197728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                   0.034472140                  0.0004126629  0.2710006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                   0.073427910                  0.0004126629  0.2853423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                   0.014086210                  0.0004126629  0.4670378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                   0.006486824                  0.0409175900  0.2115789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                   0.008285265                  0.0016655860  0.2020097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   tk02var.2. tk02var.3. clockrate.all.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.3848931  0.2075079     0.01192715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.3609312  0.3622265     0.01086355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.1831945  0.6146289     0.01349259</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.3483061  0.4949015     0.01016002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.2723863  0.3463915     0.01160514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.2846277  0.4073166     0.01075419</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Reshape FBD table to long format</span></span>
<span class="r-in"><span class="va">posterior3p_long</span> <span class="op">&lt;-</span> <span class="fu">FBD_reshape</span><span class="op">(</span><span class="va">posterior3p</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">posterior3p_long</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Gen       LnL      LnPr  TH.all.   TL.all. prop_ancfossil.all.   sigma.1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 8750000 -1449.425 -143.1907 5.271118 11.969460                   0 0.07660715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 8761000 -1458.367 -174.9627 4.775064 11.070210                   0 0.05850396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 8771000 -1449.445 -163.9216 5.927716 12.628460                   0 0.05182430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 8782000 -1453.218 -153.2030 4.451376  9.931809                   0 0.14644520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 8792000 -1461.906 -132.1172 5.095504 11.083810                   0 0.14143120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 8803000 -1452.809 -129.3066 4.715021 10.481830                   0 0.10207230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sigma.2.  sigma.3.      m.1.     m.2.     m.3. tk02var.1. tk02var.2.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.33351500 0.8523453 0.3695799 1.544579 1.362332  0.3197728  0.3848931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.06463618 0.1380557 0.5083868 1.495777 1.108471  0.2710006  0.3609312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.67980130 0.7776142 0.4275609 1.569911 1.144364  0.2853423  0.1831945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.65005980 0.2999867 0.6445027 1.329942 1.148377  0.4670378  0.3483061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.52745340 1.3928490 0.4993570 1.368074 1.445410  0.2115789  0.2723863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1.31535200 0.7405540 0.4835195 1.359665 1.508596  0.2020097  0.2846277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   tk02var.3. clockrate.all. Time_bin net_speciation relative_extinction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.2075079     0.01192715        1     0.04987983           0.6785586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.3622265     0.01086355        1     0.04675159           0.9174022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.6146289     0.01349259        1     0.01064803           0.9677827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.4949015     0.01016002        1     0.07373453           0.8976315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.3463915     0.01160514        1     0.04990040           0.7887825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.4073166     0.01075419        1     0.03950198           0.8675209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   relative_fossilization</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            0.055629950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            0.006523517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            0.010535440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            0.001264865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            0.036796000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6            0.006094768</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Tiago Simoes, Noah Greifer, Joelle Barido-Sottani, Stephanie Pierce.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

