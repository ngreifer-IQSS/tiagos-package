[{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/char-part.html","id":"character-partitioning","dir":"Articles","previous_headings":"","what":"Character Partitioning","title":"Character Partitioning","text":"Load EvoPhylo package","code":"library(EvoPhylo)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/char-part.html","id":"generate-distance-matrix","dir":"Articles","previous_headings":"Character Partitioning","what":"1. Generate distance matrix","title":"Character Partitioning","text":"Generate Gower distance matrix get_gower_dist() supplying file path .nex file containing character data matrix: , use example data matrix characters accompanies EvoPhylo.","code":"#Load a character data matrix from your local directory to produce a Gower distance matrix dist_matrix <- get_gower_dist(\"DataMatrix.nex\", numeric = FALSE) ## OR #Load an example data matrix 'DataMatrix.nex' that accompanies `EvoPhylo`. DataMatrix <- system.file(\"extdata\", \"DataMatrix.nex\", package = \"EvoPhylo\") dist_matrix <- get_gower_dist(DataMatrix, numeric = FALSE) data(characters)  dist_matrix <- get_gower_dist(characters, numeric = FALSE)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/char-part.html","id":"estimate-the-optimal-number-of-partitions","dir":"Articles","previous_headings":"Character Partitioning","what":"2. Estimate the optimal number of partitions","title":"Character Partitioning","text":"optimal number partitions (clusters) first determined using partitioning around medoids (PAM) Silhouette widths index (Si) using get_sil_widths(). latter estimate quality PAM cluster proposal relative potential clusters.  Decide number clusters based plot; , \\(k = 3\\) partitions appears optimal.","code":"## Estimate and plot number of cluster against silhouette width sw <- get_sil_widths(dist_matrix, max.k = 10) plot(sw, color = \"blue\", size = 1)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/char-part.html","id":"simple-workflow","dir":"Articles","previous_headings":"Character Partitioning","what":"3. Simple Workflow","title":"Character Partitioning","text":"3.1. Analyze clusters PAM chosen \\(k\\) value (Si) make_clusters(). 3.2. Produce simple cluster graph 3.3. Export clusters/partitions Nexus file cluster_to_nexus() write_partitioned_alignments().","code":"## Generate and vizualize clusters with PAM under chosen k value.  clusters <- make_clusters(dist_matrix, k = 3)  plot(clusters) ## Write clusters to Nexus file for Mr. Bayes cluster_to_nexus(clusters, file = \"Clusters_MB.txt\")  ## Write partitioned alignments to separate Nexus files for BEAUTi # Make reference to your original character data matrix in your local directory write_partitioned_alignments(\"DataMatrix.nex\", clusters, file = \"Clusters_BEAUTi.nex\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/char-part.html","id":"complete-workflow","dir":"Articles","previous_headings":"Character Partitioning","what":"4. Complete Workflow","title":"Character Partitioning","text":"4.1. Analyze clusters PAM chosen \\(k\\) value (Si) make_clusters(). 4.2. Produce graphic clustering (tSNEs), coloring data points according PAM clusters, independently verify PAM clustering. set tsne argument within make_clusters(). 4.3. Export clusters/partitions Nexus file cluster_to_nexus(). can copied pasted Mr. Bayes command block. Alternatively, write partitioned alignments separate Nexus files using write_partitioned_alignments(). allow import partitions separately BEAUti analyses BEAST2.","code":"#User may also generate clusters with PAM and produce a graphic clustering (tSNEs) clusters <- make_clusters(dist_matrix, k = 3, tsne = TRUE, tsne_dim = 3)  plot(clusters, nrow = 2, max.overlaps = 5) ## Write clusters to Nexus file for Mr. Bayes cluster_to_nexus(clusters, file = \"Clusters_MB.txt\")  ## Write partitioned alignments to separate Nexus files for BEAUTi # Make reference to your original character data matrix in your local directory write_partitioned_alignments(\"DataMatrix.nex\", clusters, file = \"Clusters_BEAUTi.nex\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/char-part.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Character Partitioning","text":"Simões, Tiago R., Stephanie E. Pierce. 2021. “Sustained High Rates Morphological Evolution Rise Tetrapods.” Nature Ecology & Evolution 5 (10): 1403–14. https://doi.org/10.1038/s41559-021-01532-x.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/data_treatment.html","id":"types-of-morphological-data","dir":"Articles","previous_headings":"Creating Inter-character Distance Matrices","what":"Types of morphological data","title":"Theoretical background","text":"Categorical morphological data (discrete characters) treated factors imported calculate character distances, symbols used represent different states arbitrary (e.g., equally represented letters, DNA data). continuous variables used phylogenetic characters, read separate file treated numeric data, since input values state (e.g., 0.234; 2.456; 3.567; etc) represent true distance data points.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/data_treatment.html","id":"treatment-of-inapplicable-and-missing-data","dir":"Articles","previous_headings":"Creating Inter-character Distance Matrices","what":"Treatment of inapplicable and missing data","title":"Theoretical background","text":"Categorical data including symbols inapplicable missing data (typically \"-\" \"?\", respectively) read treated separate categories data relative numerical symbols different character states (\"0\", \"1\", \"2\", etc.). Therefore, options users may follow handling morphological phylogenetic datasets account inapplicable/missing data importing EvoPhylo. Users may either convert inapplicable/missing NA may choose keep original symbols. example provided , converting inapplicable/missing conditions NA ignore respective taxa inapplicable/missing data calculate inter-character distances. resulting distance matrix introduce NaN every pairwise comparison involving two characters NA (comparisons including character 5, well pairwise comparisons involving characters 4, 5 7) (Table 2-blue). Statistical tests clustering methods utilize matrices NaN data entries removal observations contributing excessive NaN performed. However, removing observations excessive inapplicable/missing data possible character partitioning character dataset must assigned least one partition (regardless amount missing inapplicable data). Table 1. Example dataset Besides, comparisons characters inclusive states NA, latter contribute 0 difference distance matrix. instance, distance characters 6 (1,1) 7 (NA, 1) 0 (Table 2-red). implicit assumption option 1 unknown characters contribute 0 distance. Therefore, approach biases distance matrix minimizing overall distance characters lowest possible values. assumes , whatever true condition represented unknown state, always assumed equal known character states (e.g., character states scored “1” Taxa B). Alternatively, keeping original inapplicable/missing data symbol make inapplicables/missing data treated distinct categorical variable relative numeric symbols. result, pairwise comparisons characters unknown data avoid introduction NaN, allowing characters considered (Table 3-blue). approach assumes unknown states always different known states, bias distance matrix increasing overall distance characters. Fortunately, however, Gower distances (used ) normalized number variables dataset (number taxa case), reduces bias. instance, simple comparison two characters sampled two taxa (B), e.g., character 6 (1,1) character 7 (NA, 1) example online vignette, raw distance characters 1.0, Gower distance 1/2 = 0.5 (Table 3-red). Table 2. Distance matrix converting inapplicable/missing conditions “NA” Table 3. Distance matrix keeping original inapplicable/missing data symbols","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/fbd-params.html","id":"fbd-parameters-statistics-and-plots","dir":"Articles","previous_headings":"","what":"FBD Parameters Statistics and Plots","title":"Analyzing FBD Parameters","text":"demonstrate extract evolutionary rate summary statistics node Bayesian clock (time-calibrate) summary tree produced Mr. Bayes, store data frame, produce summary tables, plots. Load EvoPhylo package","code":"library(EvoPhylo)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/fbd-params.html","id":"import-combined-log-file-from-all-runs-","dir":"Articles","previous_headings":"FBD Parameters Statistics and Plots","what":"1. Import combined log file from all runs.","title":"Analyzing FBD Parameters","text":"produced using combine_log(). Alternatively, users can also use LogCombiner BEAST2 software package. first argument passed combine_log() path folder containing log files imported combined. , use posterior dataset posterior3p accompanies EvoPhylo. posterior data must first transformed wide long used functions described ; FBD_reshape() accomplishes .","code":"## Import all log (.p) files from all runs and combine them, with burn-in = 25%  ## and downsampling to 2.5k trees in each log file posterior3p <- combine_log(\"LogFiles3p\", burnin = 0.25, downsample = 1000) data(posterior3p) ## Reshape imported combined log file from wide to long with FBD_reshape posterior3p_long <- FBD_reshape(posterior3p, variables = NULL, log.type = \"MrBayes\")  ## Show first 5 lines of combined log file head(posterior3p_long, 5) ##       Gen       LnL      LnPr  TH.all.   TL.all. prop_ancfossil.all.   sigma.1. ## 1 8750000 -1449.425 -143.1907 5.271118 11.969460                   0 0.07660715 ## 2 8761000 -1458.367 -174.9627 4.775064 11.070210                   0 0.05850396 ## 3 8771000 -1449.445 -163.9216 5.927716 12.628460                   0 0.05182430 ## 4 8782000 -1453.218 -153.2030 4.451376  9.931809                   0 0.14644520 ## 5 8792000 -1461.906 -132.1172 5.095504 11.083810                   0 0.14143120 ##     sigma.2.  sigma.3.      m.1.     m.2.     m.3. tk02var.1. tk02var.2. ## 1 1.33351500 0.8523453 0.3695799 1.544579 1.362332  0.3197728  0.3848931 ## 2 0.06463618 0.1380557 0.5083868 1.495777 1.108471  0.2710006  0.3609312 ## 3 0.67980130 0.7776142 0.4275609 1.569911 1.144364  0.2853423  0.1831945 ## 4 0.65005980 0.2999867 0.6445027 1.329942 1.148377  0.4670378  0.3483061 ## 5 0.52745340 1.3928490 0.4993570 1.368074 1.445410  0.2115789  0.2723863 ##   tk02var.3. clockrate.all. Time_bin net_speciation relative_extinction ## 1  0.2075079     0.01192715        1     0.04987983           0.6785586 ## 2  0.3622265     0.01086355        1     0.04675159           0.9174022 ## 3  0.6146289     0.01349259        1     0.01064803           0.9677827 ## 4  0.4949015     0.01016002        1     0.07373453           0.8976315 ## 5  0.3463915     0.01160514        1     0.04990040           0.7887825 ##   relative_fossilization ## 1            0.055629950 ## 2            0.006523517 ## 3            0.010535440 ## 4            0.001264865 ## 5            0.036796000"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/fbd-params.html","id":"summarize-fbd-parameters-by-time-bin","dir":"Articles","previous_headings":"FBD Parameters Statistics and Plots","what":"2. Summarize FBD parameters by time bin","title":"Analyzing FBD Parameters","text":"Summary statistics FBD parameter time bin can quickly summarized using FBD_summary(): FBD parameters time bin","code":"## Summarize parameters by time bin and analysis t3.1 <- FBD_summary(posterior3p_long) t3.1 ## Export the table write.csv(t3.1, file = \"FBD_summary.csv\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/fbd-params.html","id":"plot-the-distribution-of-each-fbd-parameter","dir":"Articles","previous_headings":"FBD Parameters Statistics and Plots","what":"3. Plot the distribution of each FBD parameter","title":"Analyzing FBD Parameters","text":"() FBD parameter distributions can plotted time bin using various plotting alternatives FBD_dens_plot():","code":"## Plot distribution of the desired FBD parameter by time bin with  ## kernel density plot FBD_dens_plot(posterior3p_long, parameter = \"net_speciation\",               type = \"density\", stack = FALSE) ## Plot distribution of the desired FBD parameter by time bin with  ## stacked kernel density plot FBD_dens_plot(posterior3p_long, parameter = \"net_speciation\",               type = \"density\", stack = TRUE) ## Plot distribution of the desired FBD parameter by time bin with  ## a violin plot FBD_dens_plot(posterior3p_long, parameter = \"net_speciation\",               type = \"violin\", stack = FALSE, color = \"red\") ## Plot distribution of all FBD parameter by time bin with a violin plot p1 <- FBD_dens_plot(posterior3p_long, parameter = \"net_speciation\",                     type = \"violin\", stack = FALSE, color = \"red\") p2 <- FBD_dens_plot(posterior3p_long, parameter = \"relative_extinction\",                     type = \"violin\", stack = FALSE, color = \"cyan3\") p3 <- FBD_dens_plot(posterior3p_long, parameter = \"relative_fossilization\",                     type = \"violin\", stack = FALSE, color = \"green3\")  library(patchwork) p1 + p2 + p3 + plot_layout(nrow = 1) ## Save your plot to your working directory as a PDF ggplot2::ggsave(\"Plot_regs.pdf\", width = 12, height = 4)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/fbd-params.html","id":"test-for-assumptions","dir":"Articles","previous_headings":"FBD Parameters Statistics and Plots","what":"4. Test for assumptions","title":"Analyzing FBD Parameters","text":"step, users can perform tests normality homoscedasticity data distribution FBD parameters consideration. output determine whether parametric nonparametric tests performed subsequently. results Shapiro-Wilk normality test parameter can output seperate tables single combined table. Shapiro-Wilk normality test Shapiro-Wilk normality test Bartlett’s test Fligner-Killeen test Deviations normality can displayed graphically using FBD_normality_plot():","code":"##### Tests for normality and homoscedasticity for each FBD parameter for all time bins t3.2 <- FBD_tests1(posterior3p_long) ### Export the output table for all tests write.csv(t3.2, file = \"FBD_Tests1_Assum.csv\") # Output as separate tables  t3.2$shapiro # OR as single merged table t3.2$shapiro$net_speciation$bin <- row.names(t3.2$shapiro$net_speciation)   t3.2$shapiro$relative_extinction$bin <- row.names(t3.2$shapiro$relative_extinction)   t3.2$shapiro$relative_fossilization$bin <- row.names(t3.2$shapiro$relative_fossilization)    k1all <- rbind(t3.2$shapiro$net_speciation,                t3.2$shapiro$relative_extinction,                t3.2$shapiro$relative_fossilization,                make.row.names = FALSE) k1all ## Bartlett's test for homogeneity of variance  t3.2$bartlett ## Fligner-Killeen test for homogeneity of variance  t3.2$fligner ## Visualize deviations from normality and similarity of variances FBD_normality_plot(posterior3p_long) ## Save your plot to your working directory as a PDF ggplot2::ggsave(\"Plot_normTests.pdf\", width = 8, height = 6)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/fbd-params.html","id":"test-for-significant-fbd-shifts-between-time-bins","dir":"Articles","previous_headings":"FBD Parameters Statistics and Plots","what":"5. Test for significant FBD shifts between time bins","title":"Analyzing FBD Parameters","text":"Significant shifts FBD parameters across time bins can easily tested using parametric (Student’s t-test) nonparametric (Mann-Whitney test) pairwise comparisons FBD_tests2(). automatically calculated preferred pairwise comparison chosen user depending results assumption tests step #4 (). Significant tests Pairwise t-tests Mann-Whitney tests Mann-Whitney tests","code":"##### Test for significant differences between each time bin for each FBD parameter t3.3 <- FBD_tests2(posterior3p_long) ### Export the output table for all tests write.csv(t3.3, file = \"FBD_Tests2_Sign.csv\")  ## Pairwise t-tests # Output as separate tables  t3.3$t_tests # OR as single merged table k3.3a <- rbind(t3.3$t_tests$net_speciation,                t3.3$t_tests$relative_extinction,                t3.3$t_tests$relative_fossilization,                make.row.names = FALSE) k3.3a ## Mann-Whitney tests (use if Tests in step #4 fail assumptions) # Output as separate tables  t3.3$mwu_tests # OR as single merged table k3.3b <- rbind(t3.3$mwu_tests$net_speciation,                t3.3$mwu_tests$relative_extinction,                t3.3$mwu_tests$relative_fossilization,                make.row.names = FALSE) k3.3b"},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/offset_handling.html","id":"analyzing-trees-with-offset-ages-beast2","dir":"Articles","previous_headings":"","what":"Analyzing Trees With Offset ages (BEAST2)","title":"Analyzing Trees With Offsets","text":"SA package BEAST2 includes alternate tree offset format, can set shown FBD tutorial. uses “treeWoffset” operator sample offset every tree posterior additional parameter clock analysis. However, posterior trees produced BEAST2 offset ages directly used TreeAnnotator calculate maximum clade credibility tree (MCC), latter still assumes youngest tips dataset represent extant tips. correct , “dummy” extant taxon must added posterior trees interpreted TreeAnnotator, “dummy” extant must pruned resulting MCC tree produce final MCC tree. can done performing following steps functions EvoPhylo:","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/offset_handling.html","id":"import-the-posterior-tree-distribution-","dir":"Articles","previous_headings":"Analyzing Trees With Offset ages (BEAST2)","what":"1. Import the posterior tree distribution.","title":"Analyzing Trees With Offsets","text":"First import posterior tree distribution log file produced BEAST2. log file needed contains offset sample. order store correct age tree, going add “dummy” tip phylogeny. dummy tip age 0 sample, length age tip root tree encode age tree including offset. output transformed trees variable, practice often useful write directly new trees file.","code":"trees_file <- system.file(\"extdata\", \"ex_offset.trees\", package = \"EvoPhylo\") log_file <- system.file(\"extdata\", \"ex_offset.log\", package = \"EvoPhylo\")  ## Transform the trees to add a dummy tip converted_trees <- offset.to.dummy.metadata(trees_file, log_file) ## [1] 364.0323 ## Transform the trees to add a dummy tip and save to file converted_trees <- offset.to.dummy.metadata(trees_file, log_file,                                              output.file = \"transformed_offset.trees\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/offset_handling.html","id":"summarize-the-modified-tree-distribution","dir":"Articles","previous_headings":"Analyzing Trees With Offset ages (BEAST2)","what":"2. Summarize the modified tree distribution","title":"Analyzing Trees With Offsets","text":"Using transformed trees, can perform post-processing usual, instance using TreeAnnotator produce MCC tree.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/offset_handling.html","id":"restore-the-final-summary-tree","dir":"Articles","previous_headings":"Analyzing Trees With Offset ages (BEAST2)","what":"3. Restore the final summary tree","title":"Analyzing Trees With Offsets","text":"summary tree include dummy tip added earlier, last step process remove , get back proper extinct tree offset. , can also save tree directly file.","code":"## Find the example MCC tree from the package tree_file <- system.file(\"extdata\", \"ex_offset.MCC.tre\", package = \"EvoPhylo\") ## Then remove the dummy tip final_tree <- drop.dummy.beast(tree_file) ## The output contains the final tree and the offset final_tree$offset ## [1] 366.4744 final_tree$tree ## 'treedata' S4 object that stored information ## of ##  '/home/runner/work/_temp/Library/EvoPhylo/extdata/ex_offset.MCC.tre'. ##  ## ...@ phylo: ##  ## Phylogenetic tree with 19 tips and 18 internal nodes. ##  ## Tip labels: ##   Floweria_anomala, Floweria_arctostriata, Floweria_becraftensis, ## Floweria_chemungensis1, Floweria_chemungensis2, Floweria_chemungensis3, ... ##  ## Rooted; includes branch lengths. ##  ## with the following features available: ##   'height', 'height_0.95_HPD', 'height_median', 'height_range', 'length', ## 'length_0.95_HPD', 'length_median', 'length_range', 'posterior', 'rate', ## 'rate_0.95_HPD', 'rate_median', 'rate_range'. ##  ## # The associated data tibble abstraction: 38 × 16 ## # The 'node', 'label' and 'isTip' are from the phylo tree. ##     node label       isTip height heigh…¹ heigh…² heigh…³ length lengt…⁴ lengt…⁵ ##    <int> <chr>       <lgl> <name> <list>  <named> <list>   <dbl> <list>    <dbl> ##  1     1 Floweria_a… TRUE  <dbl>  <dbl>   <dbl>   <dbl>    2.44  <dbl>     2.19  ##  2     2 Floweria_a… TRUE  <dbl>  <dbl>   <dbl>   <dbl>    3.50  <dbl>     2.04  ##  3     3 Floweria_b… TRUE  <dbl>  <dbl>   <dbl>   <dbl>    2.65  <dbl>     0.509 ##  4     4 Floweria_c… TRUE  <dbl>  <dbl>   <dbl>   <dbl>    0.804 <dbl>     0     ##  5     5 Floweria_c… TRUE  <dbl>  <dbl>   <dbl>   <dbl>    2.46  <dbl>     0     ##  6     6 Floweria_c… TRUE  <dbl>  <dbl>   <dbl>   <dbl>   11.4   <dbl>    10.8   ##  7     7 Floweria_c… TRUE  <dbl>  <dbl>   <dbl>   <dbl>    0.360 <dbl>     0     ##  8     8 Floweria_c… TRUE  <dbl>  <dbl>   <dbl>   <dbl>   11.6   <dbl>     9.61  ##  9     9 Floweria_d… TRUE  <dbl>  <dbl>   <dbl>   <dbl>    0.597 <dbl>     0     ## 10    10 Floweria_i… TRUE  <dbl>  <dbl>   <dbl>   <dbl>    1.70  <dbl>     1.40  ## # … with 28 more rows, 6 more variables: length_range <list>, posterior <dbl>, ## #   rate <dbl>, rate_0.95_HPD <list>, rate_median <dbl>, rate_range <list>, and ## #   abbreviated variable names ¹​height_0.95_HPD, ²​height_median, ³​height_range, ## #   ⁴​length_0.95_HPD, ⁵​length_median ## Remove the dummy tip and save to file final_tree <- drop.dummy.beast(tree_file, output.file = \"ex_final_mcc.tre\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/offset_handling.html","id":"analyzing-trees-with-offset-ages-mr-bayes","dir":"Articles","previous_headings":"","what":"Analyzing Trees With Offset ages (Mr.Bayes)","title":"Analyzing Trees With Offsets","text":"Mr.Bayes equivalent procedure treeWoffset BEAST2 handling tip-dating analyses entirely extinct lineages. case, necessary manually add “dummy” extant taxon dataset beginning analyses (done Simões Pierce (2021)). “dummy” tip must scored missing data (“?”) constrained sister taxon one taxon data, fluctuate around tree wildcard. MCC trees BEAST2, final summary trees Mr.Bayes [50% majority rule consensus tree (MRC) maximum compatible tree (MCT)] extant “dummy’ taxon . can pruned using drop.dummy.mb:","code":"## Find the example MCC tree from the package tree_file_mb <- system.file(\"extdata\", \"tree_mb_dummy.tre\", package = \"EvoPhylo\")  ## Remove the dummy tip and save to file final_tree_mb <- drop.dummy.mb(tree_file_mb, output.file = \"tree_mb_final.tre\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/offset_handling.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Analyzing Trees With Offsets","text":"Barido‐Sottani, Joëlle, Nina M. . van Tiel, Melanie J. Hopkins, David F. Wright, Tanja Stadler, Rachel C. M. Warnock. 2020. “Ignoring Fossil Age Uncertainty Leads Inaccurate Topology Divergence Time Estimates Time Calibrated Tree Inference.” Frontiers Ecology Evolution 8 (June): 183. https://doi.org/10.3389/fevo.2020.00183. Simões, Tiago R., Stephanie E. Pierce. 2021. “Sustained High Rates Morphological Evolution Rise Tetrapods.” Nature Ecology & Evolution 5 (10): 1403–14. https://doi.org/10.1038/s41559-021-01532-x.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"evolutionary-rates-statistics-and-plots","dir":"Articles","previous_headings":"","what":"Evolutionary Rates Statistics and Plots","title":"Evolutionary Rates & Selection Mode","text":"section, extract evolutionary rate parameters node Bayesian clock (time-calibrated) summary tree. functions store data frame, produce summary statistics tables, create different plots showing rates distributed across morphological partitions clades. Note step 0 needs performed running inference using BEAST2. Load EvoPhylo package","code":"library(EvoPhylo)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"set-your-beast2-analysis-to-log-multiple-clocks","dir":"Articles","previous_headings":"Evolutionary Rates Statistics and Plots","what":"0. Set your BEAST2 analysis to log multiple clocks","title":"Evolutionary Rates & Selection Mode","text":"step specific BEAST2 analyses - using Mr. Bayes, skip directly step 1. using default configuration generated BEAUti, one clocks logged along tree. clocks, summary statistics (mean rate) logged. order obtain clock rates different partitions, need modify setup running inference. order , open BEAST2 XML configuration file find section logs tree, look similar : section needs duplicated additional clock, modifying name clock (branchratemodel), file name (fileName) name logger (id) like example: clock name needs reference name (id) one clock models set analysis, can found earlier XML file.","code":"<logger id=\"treelog.t:26\" spec=\"Logger\" fileName=\"multiclock.trees\" logEvery=\"10\" mode=\"tree\">   <log id=\"TreeWithMetaDataLogger.t:26\" spec=\"beast.evolution.tree.TreeWithMetaDataLogger\" branchratemodel=\"@RelaxedClock.c:26\" tree=\"@Tree.t:26\"/> <\/logger> <logger id=\"treelog.t:26.2\" spec=\"Logger\" fileName=\"multiclock.clock2.trees\" logEvery=\"10\" mode=\"tree\">   <log id=\"TreeWithMetaDataLogger.t:26\" spec=\"beast.evolution.tree.TreeWithMetaDataLogger\" branchratemodel=\"@ExponentialRelaxedClock.c:261\" tree=\"@Tree.t:26\"/> <\/logger>"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"a--get-rates-from-the-clock-tree-and-create-a-rate-table-beast2","dir":"Articles","previous_headings":"Evolutionary Rates Statistics and Plots","what":"1a. Get rates from the clock tree and create a rate table (BEAST2)","title":"Evolutionary Rates & Selection Mode","text":"section covers BEAST2 analyses - see next section equivalent using Mr. Bayes data. assume consensus summary tree generated tree log files generated inference configured step 0, instance using software TreeAnnotator. First, import summary clock trees using treeio’s function read.beast(). , use example BEAST2 clock trees 2 morphological partitions tree_clock1 tree_clock2 XXX accompany EvoPhylo. Subsequently, using get_clockrate_table(), users can extract mean median rate values node summary tree. mean median rate values calculated TreeAnnotator taking account trees posterior sample. Please note analyses must reached stationarity phase independent runs converging summary statistics node meaningful summaries posterior sample. example shown uses two different clocks, however function supports number clocks can passed separate arguments. Alternatively, different clocks can also passed list (can convenient large number clocks), shown example.","code":"## Import all clock summary trees produced by BEAST2 from your local directory  tree_clock1 <- treeio::read.beast(\"tree_file_clock1.tre\") tree_clock2 <- treeio::read.beast(\"tree_file_clock2.tre\") data(tree_clock1) data(tree_clock2) ## Get table of clock rates with summary stats for each node in  ## the tree for each relaxed clock partition (2 partitions in this dataset)  RateTable_Means_2p <- get_clockrate_table_BEAST2(tree_clock1, tree_clock2, summary = \"mean\") ## Get all clocks in list all_clocks <- list(tree_clock1, tree_clock2) ## Get table of clock rates with summary stats for each node in  ## the tree for each relaxed clock partition, with clocks as list RateTable_Means_2p <- do.call(get_clockrate_table_BEAST2, args = c(all_clocks, list(summary = \"mean\")))"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"b--get-rates-from-the-clock-tree-and-create-a-rate-table-mrbayes","dir":"Articles","previous_headings":"Evolutionary Rates Statistics and Plots","what":"1b. Get rates from the clock tree and create a rate table (MrBayes)","title":"Evolutionary Rates & Selection Mode","text":"section covers Mr. Bayes analyses - see previous section equivalent using BEAST2 data. First, import Bayesian clock tree using treeio’s function read.mrbayes() (= read.beast()). , use example Mr.Bayes single multi-clock tree 3 morphological partitions tree3p Simões Pierce (2021) accompanies EvoPhylo. Subsequently, using get_clockrate_table_MrBayes(), users can extract mean median rate values node summary tree annotated Mr. Bayes creating summary tree Mr. Bayes “sumt” command. mean median rate values calculated Mr. Bayes taking account trees posterior sample. works summary tree produced Mr. Bayes: majority rule consensus fully resolved maximum compatible tree (latter used examples ). Please note analyses must reached stationarity phase independent runs converging summary statistics node meaningful summaries posterior sample.","code":"## Import summary tree with three clock partitions produced by  ## Mr. Bayes (.t or .tre files) from your local directory  tree3p <- treeio::read.mrbayes(\"Tree3p.t\") data(tree3p) ## Get table of clock rates with summary stats for each node in  ## the tree for each relaxed clock partition (3 partitions in this tree file) RateTable_Means_3p <- get_clockrate_table_MrBayes(tree3p, summary = \"mean\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"export-the-rate-table-and-plot-tree-with-node-values","dir":"Articles","previous_headings":"Evolutionary Rates Statistics and Plots","what":"2. Export the rate table and plot tree with node values","title":"Evolutionary Rates & Selection Mode","text":"rate table obtained (Mr. Bayes BEAST2 files), necessary export . necessary step subsequently open rate table spreadsheet locally (e.g., using Microsoft Office Excel) customize table clade names associated node tree downstream analyses.","code":"## Export the rate tables (using Mr. Bayes example with 3 partitions) write.csv(RateTable_Means_3p, file = \"RateTable_Means_3p.csv\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"plot-tree-node-labels-to-customize-clade-names","dir":"Articles","previous_headings":"","what":"Plot tree node labels to customize clade names","title":"Evolutionary Rates & Selection Mode","text":"visualize node values tree, can use ggtree().","code":"## Plot tree node labels library(ggtree) tree_nodes <- ggtree(tree3p, branch.length = \"none\", size = 0.05) +   geom_tiplab(size = 2, linesize = 0.01, color = \"black\", offset = 0.5) +   geom_label(aes(label = node), size = 2, color=\"purple\") tree_nodes ## Save your plot to your working directory as a PDF ggplot2::ggsave(\"Tree_nodes.pdf\", width = 10, height = 10)"},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"a-new-clade-column-has-been-added-to-the-rates-table","dir":"Articles","previous_headings":"","what":"A new “clade” column has been added to the rates table","title":"Evolutionary Rates & Selection Mode","text":", use rate table clade membership RateTable_Means_3p_Clades accompanies EvoPhylo.","code":"## Import rate table with clade membership (new \"clade\" column added)  ## from your local directory RateTable_Means_3p_Clades <- read.csv(\"RateTable_Means_3p_Clades.csv\", header = TRUE) data(RateTable_Means_3p_Clades)  head(RateTable_Means_3p_Clades) ##         clade nodes   rates1   rates2   rates3 ## 1 Dipnomorpha     1 0.943696 0.981486 1.006164 ## 2 Dipnomorpha     2 1.065326 0.772074 0.913194 ## 3 Dipnomorpha     3 1.182460 0.656872 0.813618 ## 4 Dipnomorpha     4 1.229767 0.523709 0.722519 ## 5 Dipnomorpha     5 1.230564 0.517773 0.720479 ## 6       Other     6 0.658855 0.717277 0.663950"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"get-summary-stats-for-each-cladeclock-partition","dir":"Articles","previous_headings":"A new “clade” column has been added to the rates table","what":"4. Get summary stats for each clade/clock partition","title":"Evolutionary Rates & Selection Mode","text":"Obtain summary statistics table plots clade clock partition using clockrate_summary(). Supplying file path file save output file. Rate table summary statistics","code":"## Get summary statistics table for each clade by clock  clockrate_summary(RateTable_Means_3p_Clades,                   file = \"Sum_RateTable_Means_3p.csv\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"plot-rates-by-clock-partition-and-clade","dir":"Articles","previous_headings":"A new “clade” column has been added to the rates table","what":"5. Plot rates by clock partition and clade","title":"Evolutionary Rates & Selection Mode","text":"Plot distributions rates clock partition clade clockrate_dens_plot().  Sometimes using stacked plots provides better visualization avoids overlapping distributions.  also possible append extra layers using ggplot2 function, changing color scale. , change color scale Viridis scale.","code":"## Overlapping plots clockrate_dens_plot(RateTable_Means_3p_Clades, stack = FALSE,                     nrow = 1, scales = \"fixed\") ## Stacked plots clockrate_dens_plot(RateTable_Means_3p_Clades, stack = TRUE,                     nrow = 1, scales = \"fixed\") ## Stacked plots with viridis color scale clockrate_dens_plot(RateTable_Means_3p_Clades, stack = TRUE,                     nrow = 1, scales = \"fixed\") +   ggplot2::scale_color_viridis_d() +   ggplot2::scale_fill_viridis_d()"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"rate-linear-models","dir":"Articles","previous_headings":"A new “clade” column has been added to the rates table","what":"6. Rate linear models","title":"Evolutionary Rates & Selection Mode","text":"can also plot linear model regressions rates two clocks clockrate_reg_plot().","code":"## Plot regressions of rates from two clocks p12 <- clockrate_reg_plot(RateTable_Means_3p_Clades, clock_x = 1, clock_y = 2) p13 <- clockrate_reg_plot(RateTable_Means_3p_Clades, clock_x = 1, clock_y = 3) p23 <- clockrate_reg_plot(RateTable_Means_3p_Clades, clock_x = 2, clock_y = 3)  library(patchwork) #for combining plots p12 + p13 + p23 + plot_layout(ncol = 2) ## Save your plot to your working directory as a PDF ggplot2::ggsave(\"Plot_regs.pdf\", width = 8, height = 8)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"addendum-example-using-rates-from-single-clock-analysis-no-partitioning","dir":"Articles","previous_headings":"A new “clade” column has been added to the rates table","what":"ADDENDUM: Example using rates from single clock analysis (no partitioning)","title":"Evolutionary Rates & Selection Mode","text":"can also explore clock rates summary trees including single clock shared among character partitions (unpartitioned analysis): , use example tree tree1p accompanies EvoPhylo. , get table clock rates summary stats node tree relaxed clock partition. proceed analysis, case multiple clocks. Rate table summary statistics  can done similar way BEAST2 analysis. Since BEAST2 outputs one clock rate summary tree file, procedures follow exactly multiple clocks, except one clock tree file imported.","code":"## Import summary tree with a single clock partitions produced by  ## Mr. Bayes (.t or .tre files) from examples directory tree1p <- treeio::read.mrbayes(\"Tree1p.t\") data(tree1p) RateTable_Means_1p <- get_clockrate_table_MrBayes(tree1p, summary = \"mean\") ## Export the rate tables write.csv(RateTable_Means_1p, file = \"RateTable_Means1.csv\")  ## Import rate table after adding clade membership (new \"clade\" column added) RateTable_Means_1p_Clades <- read.csv(\"RateTable_Means1_Clades.csv\", header = TRUE) #Below, we use the rate table with clade membership `RateTable_Means_1p_Clades` that accompanies `EvoPhylo`. data(RateTable_Means_1p_Clades) ## Get summary statistics table for each clade by clock  clockrate_summary(RateTable_Means_1p_Clades,                   file = \"Sum_RateTable_Medians1.csv\") ## Stacked plots with viridis color scale clockrate_dens_plot(RateTable_Means_1p_Clades, stack = TRUE,                     nrow = 1, scales = \"fixed\") +   ggplot2::scale_color_viridis_d() +   ggplot2::scale_fill_viridis_d()"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"selection-mode","dir":"Articles","previous_headings":"","what":"Selection Mode","title":"Evolutionary Rates & Selection Mode","text":"section, use evolutionary rate based inference selection mode, first introduced Baker et al. (2016) continuous traits, later adapted clock-based rates Simões Pierce (2021).","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"import-and-transform-table","dir":"Articles","previous_headings":"Selection Mode","what":"1. Import and transform table","title":"Evolutionary Rates & Selection Mode","text":", use rate table clade membership RateTable_Means_3p_Clades accompanies EvoPhylo. necessary transform table wide long format clock_reshape().","code":"## Import rate table with clade membership (new \"clade\" column added)  ## from your local directory with \"mean\" values RateTable_Means_3p_Clades <- read.csv(\"RateTable_Means_Clades.csv\", header = TRUE) data(RateTable_Means_3p_Clades) ## Transform table from wide to long format rates_by_clade <- clock_reshape(RateTable_Means_3p_Clades)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"import-combined-log-file-from-all-runs-","dir":"Articles","previous_headings":"Selection Mode","what":"2. Import combined log file from all runs.","title":"Evolutionary Rates & Selection Mode","text":"produced using combine_log(). Alternatively, users can also use LogCombiner BEAST2 software package. first argument passed combine_log() path folder containing log files imported combined. , use posterior dataset posterior3p accompanies EvoPhylo.","code":"## Import all log (.p) files from all runs and combine them, with burn-in = 25%  ## and downsampling to 2.5k trees in each log file posterior3p <- combine_log(\"LogFiles3p\", burnin = 0.25, downsample = 1000) data(posterior3p)  ## Show first 10 lines of combined log file head(posterior3p, 10)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"pairwise-t-tests-of-rate-values-among-clades","dir":"Articles","previous_headings":"Selection Mode","what":"3. Pairwise t-tests of rate values among clades","title":"Evolutionary Rates & Selection Mode","text":"function get_pwt_rates() produce table pairwise t-tests differences mean clockrate value posterior absolute rate tree node. Combined log file","code":"## Get table of pairwise t-tests for difference between the posterior  ## mean and the rate for each tree node RateSign_Tests <- get_pwt_rates(RateTable_Means_3p_Clades, posterior3p)  ## Show first 10 lines of table head(RateSign_Tests, 10) ## Export the table write.csv(RateSign_Tests, file = \"RateSign_Tests.csv\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"plot-selection-gradient-on-the-summary-tree","dir":"Articles","previous_headings":"Selection Mode","what":"4. Plot selection gradient on the summary tree","title":"Evolutionary Rates & Selection Mode","text":"Using different thresholds, Identify selection mode across branches tree clock partition plot_treerates_sgn().  Plot tree using various thresholds clock partitions combine .","code":"## Plot tree using various thresholds for clock partition 1 A1 <- plot_treerates_sgn(   tree3p, posterior3p,    clock = 1,               #Show rates for clock partition 1   summary = \"mean\",        #sets summary stats to get from summary tree nodes   branch_size = 1.5, tip_size = 3,                      #sets size for tree elements   xlim = c(-450, -260), nbreaks = 8, geo_size = list(3, 3),  #sets limits and breaks for geoscale   threshold = c(\"1 SD\", \"3 SD\"))                 #sets threshold for selection mode ## [1] \"-3 SD\" \"-1 SD\" \"+1 SD\" \"+3 SD\" ## [1] 0.2447693 0.7482564 1.2517436 1.7552307 A1 ## Plot tree using various thresholds for other clock partition and combine them A2 <- plot_treerates_sgn(   tree3p, posterior3p,    clock = 2,               #Show rates for clock partition 2   summary = \"mean\",        #sets summary stats to get from summary tree nodes   branch_size = 1.5, tip_size = 3,                      #sets size for tree elements   xlim = c(-450, -260), nbreaks = 8, geo_size = list(3, 3),  #sets limits and breaks for geoscale   threshold = c(\"1 SD\", \"3 SD\"))                 #sets threshold for selection mode ## [1] \"-3 SD\" \"-1 SD\" \"+1 SD\" \"+3 SD\" ## [1] 0.2447693 0.7482564 1.2517436 1.7552307 A3 <- plot_treerates_sgn(   tree3p, posterior3p,    clock = 3,               #Show rates for clock partition 2   summary = \"mean\",        #sets summary stats to get from summary tree nodes   branch_size = 1.5, tip_size = 3,                      #sets size for tree elements   xlim = c(-450, -260), nbreaks = 8, geo_size = list(3, 3),  #sets limits and breaks for geoscale   threshold = c(\"1 SD\", \"3 SD\"))                 #sets threshold for selection mode ## [1] \"-3 SD\" \"-1 SD\" \"+1 SD\" \"+3 SD\" ## [1] 0.2447693 0.7482564 1.2517436 1.7552307 library(patchwork) A1 + A2 + A3 + plot_layout(nrow = 1) ## Save your plot to your working directory as a PDF ggplot2::ggsave(\"Tree_Sel_3p.pdf\", width = 20, height = 8)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/articles/rates-selection.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Evolutionary Rates & Selection Mode","text":"Baker, Joanna, Andrew Meade, Mark Pagel, Chris Venditti. 2016. “Positive Phenotypic Selection Inferred Phylogenies.” Biological Journal Linnean Society 118 (1): 95–115. Simões, Tiago R., Stephanie E. Pierce. 2021. “Sustained High Rates Morphological Evolution Rise Tetrapods.” Nature Ecology & Evolution 5 (10): 1403–14. https://doi.org/10.1038/s41559-021-01532-x.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Tiago Simoes. Maintainer, author. Noah Greifer. Author. Joelle Barido-Sottani. Author. Stephanie Pierce. Author.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Simões, T. R., Greifer, N., Barido-Sottani, J., & Pierce, S. E. 2022. EvoPhylo: R package pre- postprocessing morphological data relaxed clock Bayesian phylogenetics. EcoEvoRxiv. https://doi.org/10.32942/osf.io/3mkf9","code":"@Article{,   title = {EvoPhylo: an R package for pre- and postprocessing of morphological data from relaxed clock Bayesian phylogenetics},   author = {Tiago R. Simões and Noah Greifer and Joëlle Barido-Sottani and Stephanie E. Pierce},   journal = {Preprint at EcoEvoRxiv},   year = {2022},   volume = {n/a},   pages = {n/a},   note = {Preprint at https://doi.org/10.32942/osf.io/3mkf9}, }"},{"path":"https://tiago-simoes.github.io/EvoPhylo/index.html","id":"evophylo-pre--and-postprocessing-of-morphological-data-from-relaxed-clock-bayesian-phylogenetics","dir":"","previous_headings":"","what":"Pre- And Postprocessing of Morphological Data from Relaxed Clock Bayesian Phylogenetics","title":"Pre- And Postprocessing of Morphological Data from Relaxed Clock Bayesian Phylogenetics","text":"package perform automated morphological character partitioning phylogenetic analyses analyze macroevolutionary parameter outputs clock (time-calibrated) Bayesian inference analyses. EvoPhylo initially released pre- postprocess data using software Mr. Bayes, since version 0.3 also handles data pre- post-processing software package BEAST2. ideas rationale behind original functionality objectives analyses available package first presented Simões & Pierce (2021). ’s current functionality described detail Simões, Grifer, Barido-Sottani & Pierce (2022).","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/index.html","id":"installing-package-evophylo","dir":"","previous_headings":"","what":"Installing package EvoPhylo","title":"Pre- And Postprocessing of Morphological Data from Relaxed Clock Bayesian Phylogenetics","text":"Install latest release version (v. 0.3) directly CRAN: development version Github:","code":"install.packages(\"EvoPhylo\") # install.packages(\"devtools\") devtools::install_github(\"tiago-simoes/EvoPhylo\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/index.html","id":"tutorials","dir":"","previous_headings":"","what":"Tutorials","title":"Pre- And Postprocessing of Morphological Data from Relaxed Clock Bayesian Phylogenetics","text":"See vignette(\"char-part\"),vignette(\"data_treatment\"), vignette(\"rates-selection\"), vignette(\"fbd-params\"), vignette(\"offset_handling\"), step--step guides using EvoPhylo perform analyses, also available EvoPhylo website.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/index.html","id":"authors-including-current-developers","dir":"","previous_headings":"","what":"Authors (including current developers)","title":"Pre- And Postprocessing of Morphological Data from Relaxed Clock Bayesian Phylogenetics","text":"Tiago R. Simões: Conceptualization code development - Github Profile Noah Greifer: Code development Joëlle Barido-Sottani: Code development Stephanie E.Pierce: Project supervision","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Pre- And Postprocessing of Morphological Data from Relaxed Clock Bayesian Phylogenetics","text":"project licensed General Public License, version 2.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_dens_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Density plots for each FBD parameter — FBD_dens_plot","title":"Density plots for each FBD parameter — FBD_dens_plot","text":"Produces density violin plot displaying distribution FBD parameter samples time bin.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_dens_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density plots for each FBD parameter — FBD_dens_plot","text":"","code":"FBD_dens_plot(posterior, parameter, type = \"density\",               stack = FALSE, color = \"red\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_dens_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density plots for each FBD parameter — FBD_dens_plot","text":"posterior data frame posterior parameter estimates containing single \"Time_bin\" column one column FBD parameter value. data frame can imported using combine_log followed FBD_reshape. parameter string containing name FBD parameter data frame; abbreviations allowed. type type plot; either \"density\" density plot \"violin\" violin plots. Abbreviations allowed. stack type = \"density\", whether produce stacked densities (TRUE) overlapping densities (FALSE, default). Ignored otherwise. color type = \"violin\", color plotted densities.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_dens_plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Density plots for each FBD parameter — FBD_dens_plot","text":"Density plots produced using ggplot2::stat_density, violin plots produced using ggplot2::geom_violin. violin plots, horizontal line indicates median (density), black dot indicates mean.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_dens_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density plots for each FBD parameter — FBD_dens_plot","text":"ggplot object, can modified using ggplot2 functions.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_dens_plot.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Density plots for each FBD parameter — FBD_dens_plot","text":"setting type = \"violin\", warning may appear saying something like \"regularize.values(x, y, ties, missing(ties), na.rm = na.rm) : collapsing unique 'x' values\". warning can ignored.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_dens_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Density plots for each FBD parameter — FBD_dens_plot","text":"","code":"# See vignette(\"fbd-params\") for how to use this # function as part of an analysis pipeline  data(\"posterior3p\")  posterior3p_long <- FBD_reshape(posterior3p)  FBD_dens_plot(posterior3p_long, parameter = \"net_speciation\",               type = \"density\", stack = FALSE)   FBD_dens_plot(posterior3p_long, parameter = \"net_speciation\",               type = \"density\", stack = TRUE)   FBD_dens_plot(posterior3p_long, parameter = \"net_speciation\",               type = \"violin\", color = \"red\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_normality_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Inspect FBD parameter distributions visually — FBD_normality_plot","title":"Inspect FBD parameter distributions visually — FBD_normality_plot","text":"Produces plots distributions fossilized birth–death process (FBD) parameters facilitate assessment assumptions normality within time bins homogeneity variance across time bins.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_normality_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inspect FBD parameter distributions visually — FBD_normality_plot","text":"","code":"FBD_normality_plot(posterior)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_normality_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inspect FBD parameter distributions visually — FBD_normality_plot","text":"posterior data frame posterior parameter estimates containing single \"Time_bin\" column one column FBD parameter value. data frame can imported using combine_log followed FBD_reshape.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_normality_plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inspect FBD parameter distributions visually — FBD_normality_plot","text":"plots produced include density plots parameter within time bin (residualized mean zero), scaled top density value one (black). Superimposed onto densitys densities normal distribution mean variance (scaled amount) (red). Deviations normal density red density parameters black indiciate deviations normality. standard deviation parameter also displayed time bin facilitate assessing homogenity variance.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_normality_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inspect FBD parameter distributions visually — FBD_normality_plot","text":"ggplot object, can modified using ggplot2 functions.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_normality_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inspect FBD parameter distributions visually — FBD_normality_plot","text":"","code":"# See vignette(\"fbd-params\") for how to use this # function as part of an analysis pipeline  data(\"posterior3p\")  posterior3p_long <- FBD_reshape(posterior3p)  FBD_normality_plot(posterior3p_long)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_reshape.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert an FBD posterior parameter table from wide to long format — FBD_reshape","title":"Convert an FBD posterior parameter table from wide to long format — FBD_reshape","text":"Converts FBD posterior parameter table, imported using combine_log, wide long format.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_reshape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert an FBD posterior parameter table from wide to long format — FBD_reshape","text":"","code":"FBD_reshape(posterior, variables = NULL, log.type = c(\"MrBayes\", \"BEAST2\"))"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_reshape.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert an FBD posterior parameter table from wide to long format — FBD_reshape","text":"posterior Single posterior parameter sample dataset skyline FBD parameters produced combine_log. variables Names FBD rate variables log. NULL (default), attempt auto-detect names log type. log.type Name software produced log (currently supported: MrBayes BEAST2). set variables NULL.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_reshape.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert an FBD posterior parameter table from wide to long format — FBD_reshape","text":"posterior parameters log files produced Bayesian evolutionary analyses using skyline birth-death tree models, including skyline FBD model, result two estimates FBD parameter, one time bin. function convert table parameters skyline FBD parameters wide long format, one row per generation per time bin new column \"Time_bin\" containing respective time bins factor. long format necessary downstream analyses using FBD_summary, FBD_dens_plot, FBD_normality_plot, FBD_tests1, FBD_tests2, similarly done clock_reshape clock rate tables. format log files can either specified using variables log.type auto-detected function. \"posterior\" data frame can obtained reading log file directly (e.g. using read.table function) combining several output log files Mr. Bayes using combine_log.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_reshape.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert an FBD posterior parameter table from wide to long format — FBD_reshape","text":"data frame posterior parameter estimates containing single \"Time_bin\" column one column FBD parameter value.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_reshape.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert an FBD posterior parameter table from wide to long format — FBD_reshape","text":"","code":"# See vignette(\"fbd-params\") for how to use this # function as part of an analysis pipeline  data(\"posterior3p\")  head(posterior3p) #>       Gen       LnL      LnPr  TH.all.   TL.all. prop_ancfossil.all.   sigma.1. #> 1 8750000 -1449.425 -143.1907 5.271118 11.969460                   0 0.07660715 #> 2 8761000 -1458.367 -174.9627 4.775064 11.070210                   0 0.05850396 #> 3 8771000 -1449.445 -163.9216 5.927716 12.628460                   0 0.05182430 #> 4 8782000 -1453.218 -153.2030 4.451376  9.931809                   0 0.14644520 #> 5 8792000 -1461.906 -132.1172 5.095504 11.083810                   0 0.14143120 #> 6 8803000 -1452.809 -129.3066 4.715021 10.481830                   0 0.10207230 #>     sigma.2.  sigma.3.      m.1.     m.2.     m.3. net_speciation_1.all. #> 1 1.33351500 0.8523453 0.3695799 1.544579 1.362332            0.04987983 #> 2 0.06463618 0.1380557 0.5083868 1.495777 1.108471            0.04675159 #> 3 0.67980130 0.7776142 0.4275609 1.569911 1.144364            0.01064803 #> 4 0.65005980 0.2999867 0.6445027 1.329942 1.148377            0.07373453 #> 5 0.52745340 1.3928490 0.4993570 1.368074 1.445410            0.04990040 #> 6 1.31535200 0.7405540 0.4835195 1.359665 1.508596            0.03950198 #>   net_speciation_2.all. net_speciation_3.all. net_speciation_4.all. #> 1           0.030036060           0.009395822            0.02637372 #> 2           0.013372350           0.021293800            0.02126325 #> 3           0.010895640           0.017047410            0.04032594 #> 4           0.007208267           0.021414940            0.03326603 #> 5           0.006333419           0.019637100            0.01893420 #> 6           0.005410397           0.026179850            0.02002429 #>   relative_extinction_1.all. relative_extinction_2.all. #> 1                  0.6785586                  0.9373640 #> 2                  0.9174022                  0.9838011 #> 3                  0.9677827                  0.9857446 #> 4                  0.8976315                  0.9883790 #> 5                  0.7887825                  0.9883790 #> 6                  0.8675209                  0.9851012 #>   relative_extinction_3.all. relative_extinction_4.all. #> 1                  0.9555714                0.002227504 #> 2                  0.5125231                0.028959450 #> 3                  0.9032853                0.012431660 #> 4                  0.9464226                0.011271430 #> 5                  0.9658652                0.008529459 #> 6                  0.9268501                0.026359290 #>   relative_fossilization_1.all. relative_fossilization_2.all. #> 1                   0.055629950                    0.03741083 #> 2                   0.006523517                    0.02198622 #> 3                   0.010535440                    0.02155796 #> 4                   0.001264865                    0.02106140 #> 5                   0.036796000                    0.03160199 #> 6                   0.006094768                    0.04703950 #>   relative_fossilization_3.all. relative_fossilization_4.all. tk02var.1. #> 1                   0.020690570                  0.0253022700  0.3197728 #> 2                   0.034472140                  0.0004126629  0.2710006 #> 3                   0.073427910                  0.0004126629  0.2853423 #> 4                   0.014086210                  0.0004126629  0.4670378 #> 5                   0.006486824                  0.0409175900  0.2115789 #> 6                   0.008285265                  0.0016655860  0.2020097 #>   tk02var.2. tk02var.3. clockrate.all. #> 1  0.3848931  0.2075079     0.01192715 #> 2  0.3609312  0.3622265     0.01086355 #> 3  0.1831945  0.6146289     0.01349259 #> 4  0.3483061  0.4949015     0.01016002 #> 5  0.2723863  0.3463915     0.01160514 #> 6  0.2846277  0.4073166     0.01075419  ## Reshape FBD table to long format posterior3p_long <- FBD_reshape(posterior3p)  head(posterior3p_long) #>       Gen       LnL      LnPr  TH.all.   TL.all. prop_ancfossil.all.   sigma.1. #> 1 8750000 -1449.425 -143.1907 5.271118 11.969460                   0 0.07660715 #> 2 8761000 -1458.367 -174.9627 4.775064 11.070210                   0 0.05850396 #> 3 8771000 -1449.445 -163.9216 5.927716 12.628460                   0 0.05182430 #> 4 8782000 -1453.218 -153.2030 4.451376  9.931809                   0 0.14644520 #> 5 8792000 -1461.906 -132.1172 5.095504 11.083810                   0 0.14143120 #> 6 8803000 -1452.809 -129.3066 4.715021 10.481830                   0 0.10207230 #>     sigma.2.  sigma.3.      m.1.     m.2.     m.3. tk02var.1. tk02var.2. #> 1 1.33351500 0.8523453 0.3695799 1.544579 1.362332  0.3197728  0.3848931 #> 2 0.06463618 0.1380557 0.5083868 1.495777 1.108471  0.2710006  0.3609312 #> 3 0.67980130 0.7776142 0.4275609 1.569911 1.144364  0.2853423  0.1831945 #> 4 0.65005980 0.2999867 0.6445027 1.329942 1.148377  0.4670378  0.3483061 #> 5 0.52745340 1.3928490 0.4993570 1.368074 1.445410  0.2115789  0.2723863 #> 6 1.31535200 0.7405540 0.4835195 1.359665 1.508596  0.2020097  0.2846277 #>   tk02var.3. clockrate.all. Time_bin net_speciation relative_extinction #> 1  0.2075079     0.01192715        1     0.04987983           0.6785586 #> 2  0.3622265     0.01086355        1     0.04675159           0.9174022 #> 3  0.6146289     0.01349259        1     0.01064803           0.9677827 #> 4  0.4949015     0.01016002        1     0.07373453           0.8976315 #> 5  0.3463915     0.01160514        1     0.04990040           0.7887825 #> 6  0.4073166     0.01075419        1     0.03950198           0.8675209 #>   relative_fossilization #> 1            0.055629950 #> 2            0.006523517 #> 3            0.010535440 #> 4            0.001264865 #> 5            0.036796000 #> 6            0.006094768"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize FBD posterior parameter estimates — FBD_summary","title":"Summarize FBD posterior parameter estimates — FBD_summary","text":"Produces numerical summaries fossilized birth–death process (FBD) posterior parameter time bin.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize FBD posterior parameter estimates — FBD_summary","text":"","code":"FBD_summary(posterior, file = NULL, digits = 3)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize FBD posterior parameter estimates — FBD_summary","text":"posterior data frame posterior parameter estimates containing single \"Time_bin\" column one column FBD parameter value. data frame can imported using combine_log followed FBD_reshape. file optional file path resulting table stored using write.csv. digits number digitis round summary results . Default 3. See round.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize FBD posterior parameter estimates — FBD_summary","text":"data frame row paramater time bin, columns different summary statistics. include number data points (n) mean, standard deviation (sd), minimum value (min), first quartile (Q1), median, third quartile (Q3), maximum value (max). file NULL, .csv file containing data frame saved filepath specified file output returned invisibly.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize FBD posterior parameter estimates — FBD_summary","text":"","code":"# See vignette(\"fbd-params\") for how to use this # function as part of an analysis pipeline  data(\"posterior3p\")  posterior3p_long <- FBD_reshape(posterior3p)  FBD_summary(posterior3p_long) #>                 parameter Time_bin     n  mean    sd   min    Q1 median    Q3 #> 1          net_speciation        1 10000 0.044 0.019 0.000 0.031  0.043 0.057 #> 2          net_speciation        2 10000 0.028 0.016 0.001 0.015  0.025 0.037 #> 3          net_speciation        3 10000 0.020 0.013 0.000 0.011  0.018 0.027 #> 4          net_speciation        4 10000 0.047 0.024 0.000 0.029  0.047 0.065 #> 5     relative_extinction        1 10000 0.785 0.152 0.075 0.711  0.823 0.897 #> 6     relative_extinction        2 10000 0.926 0.048 0.551 0.901  0.935 0.961 #> 7     relative_extinction        3 10000 0.946 0.050 0.176 0.929  0.959 0.977 #> 8     relative_extinction        4 10000 0.031 0.096 0.000 0.000  0.000 0.007 #> 9  relative_fossilization        1 10000 0.039 0.051 0.000 0.011  0.023 0.047 #> 10 relative_fossilization        2 10000 0.066 0.043 0.002 0.035  0.055 0.086 #> 11 relative_fossilization        3 10000 0.014 0.021 0.000 0.003  0.007 0.016 #> 12 relative_fossilization        4 10000 0.043 0.112 0.000 0.000  0.001 0.020 #>      max #> 1  0.168 #> 2  0.123 #> 3  0.122 #> 4  0.117 #> 5  0.998 #> 6  0.998 #> 7  1.000 #> 8  0.973 #> 9  0.723 #> 10 0.359 #> 11 0.542 #> 12 0.990"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests1.html","id":null,"dir":"Reference","previous_headings":"","what":"Test assumptions of normality and homoscedasticity for FBD posterior parameters — FBD_tests1","title":"Test assumptions of normality and homoscedasticity for FBD posterior parameters — FBD_tests1","text":"Produces tests normality (within time bin, ignoring time bin, pooling within-time bin values) homoscedasticity (homogeneity variances) fossilized birth–death process (FBD) parameter posterior parameter log file.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test assumptions of normality and homoscedasticity for FBD posterior parameters — FBD_tests1","text":"","code":"FBD_tests1(posterior, downsample = TRUE)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test assumptions of normality and homoscedasticity for FBD posterior parameters — FBD_tests1","text":"posterior data frame posterior parameter estimates containing single \"Time_bin\" column one column FBD parameter value. data frame can imported using combine_log followed FBD_reshape. downsample Whether downsample observations ensure Shapiro-Wilk normality tests can run. TRUE, observations dropped 5000 observations used tests full dataset, required shapiro.test. dropped evenly spaced intervals. FALSE 5000 observations test, test run.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Test assumptions of normality and homoscedasticity for FBD posterior parameters — FBD_tests1","text":"FBD_tests1() performs several tests posterior distributions parameter values within across time bins. produces Shapiro-Wilk test normality using shapiro.test Bartlett Fligner tests homogeneity variance using bartlett.test fligner.test, respectively. Note tests likely significant even observations approximately normally distributed approximately equal variance; therefore, supplemented visual inspection using FBD_normality_plot.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test assumptions of normality and homoscedasticity for FBD posterior parameters — FBD_tests1","text":"list containing results three tests following elements: shapiro list element parameter. element data frame row time bin test statistic p-value Shapiro-Wilk test normality. addition, row overall test, combining observations ignoring time bin, test residuals, combines group-mean-centered observations (equivalent residuals regression parameter time bin). bartlett data frame Bartlett test homogeneity variance across time bins row parameter test statistic p-value test. fligner data frame Fligner test homogeneity variance across time bins row parameter test statistic p-value test.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test assumptions of normality and homoscedasticity for FBD posterior parameters — FBD_tests1","text":"","code":"# See vignette(\"fbd-params\") for how to use this # function as part of an analysis pipeline  data(\"posterior3p\")  posterior3p_long <- FBD_reshape(posterior3p)  FBD_tests1(posterior3p_long) #> $shapiro #> $shapiro$net_speciation #>                 parameter statistic      p-value #> Time bin 1 net_speciation 0.9916663 1.624982e-06 #> Time bin 2 net_speciation 0.9384888 2.480773e-22 #> Time bin 3 net_speciation 0.9227161 8.116099e-25 #> Time bin 4 net_speciation 0.9898368 1.300460e-07 #> Overall    net_speciation 0.9568434 4.033827e-36 #> Residuals  net_speciation 0.9873721 9.370749e-21 #>  #> $shapiro$relative_extinction #>                      parameter statistic      p-value #> Time bin 1 relative_extinction 0.8927465 1.249128e-28 #> Time bin 2 relative_extinction 0.9247265 1.597560e-24 #> Time bin 3 relative_extinction 0.8044308 2.275700e-36 #> Time bin 4 relative_extinction 0.3774844 4.955610e-54 #> Overall    relative_extinction 0.7036392 3.008792e-69 #> Residuals  relative_extinction 0.8237642 3.187737e-59 #>  #> $shapiro$relative_fossilization #>                         parameter statistic      p-value #> Time bin 1 relative_fossilization 0.5763573 9.277693e-48 #> Time bin 2 relative_fossilization 0.8852625 1.887972e-29 #> Time bin 3 relative_fossilization 0.6209885 5.094795e-46 #> Time bin 4 relative_fossilization 0.4636627 1.482086e-51 #> Overall    relative_fossilization 0.5473039 5.146876e-78 #> Residuals  relative_fossilization 0.5530980 9.682903e-78 #>  #>  #> $bartlett #>                parameter statistic p-value #> 1         net_speciation  3815.464       0 #> 2    relative_extinction 18159.213       0 #> 3 relative_fossilization 25654.975       0 #>  #> $fligner #>                parameter statistic p-value #> 1         net_speciation  3748.140       0 #> 2    relative_extinction 12599.843       0 #> 3 relative_fossilization  4808.545       0 #>"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests2.html","id":null,"dir":"Reference","previous_headings":"","what":"Test for differences in FBD parameter values — FBD_tests2","title":"Test for differences in FBD parameter values — FBD_tests2","text":"FBD_tests2() performs t-tests Mann-Whitney U-tests compare average value fossilized birth–death process (FBD) parameters time bins.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test for differences in FBD parameter values — FBD_tests2","text":"","code":"FBD_tests2(posterior, p.adjust.method = \"fdr\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test for differences in FBD parameter values — FBD_tests2","text":"posterior data frame posterior parameter estimates containing single \"Time_bin\" column one column FBD parameter value. data frame can imported using combine_log followed FBD_reshape. p.adjust.method method use adjust p-values multiple testing. See p.adjust details options. Default \"fdr\" Benjamini-Hochberg false discovery rate correction.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Test for differences in FBD parameter values — FBD_tests2","text":"pairwise.t.test pairwise.wilcox.test used calculate, respectively, t-test Mann-Whitney U-tests statistics p-values. power tests depends number posterior samples, can helpful examine distributions FBD parameter posteriors using FBD_dens_plot instead relying heavily tests.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test for differences in FBD parameter values — FBD_tests2","text":"list element test, contains list test results parameter. results form data frame containing sample sizes unadjusted adjusted p-values comparison.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/FBD_tests2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test for differences in FBD parameter values — FBD_tests2","text":"","code":"# See vignette(\"fbd-params\") for how to use this # function as part of an analysis pipeline  data(\"posterior3p\")  posterior3p_long <- FBD_reshape(posterior3p)  FBD_tests2(posterior3p_long) #> $t_tests #> $t_tests$net_speciation #>        parameter Time_bin1 Time_bin2    n1    n2       p-value   p-value adj #> 1 net_speciation         1         2 10000 10000  0.000000e+00  0.000000e+00 #> 2 net_speciation         1         3 10000 10000  0.000000e+00  0.000000e+00 #> 3 net_speciation         1         4 10000 10000  6.233495e-24  6.233495e-24 #> 4 net_speciation         2         3 10000 10000 2.211519e-178 2.653822e-178 #> 5 net_speciation         2         4 10000 10000  0.000000e+00  0.000000e+00 #> 6 net_speciation         3         4 10000 10000  0.000000e+00  0.000000e+00 #>  #> $t_tests$relative_extinction #>             parameter Time_bin1 Time_bin2    n1    n2      p-value  p-value adj #> 1 relative_extinction         1         2 10000 10000 0.000000e+00 0.000000e+00 #> 2 relative_extinction         1         3 10000 10000 0.000000e+00 0.000000e+00 #> 3 relative_extinction         1         4 10000 10000 0.000000e+00 0.000000e+00 #> 4 relative_extinction         2         3 10000 10000 3.621037e-48 3.621037e-48 #> 5 relative_extinction         2         4 10000 10000 0.000000e+00 0.000000e+00 #> 6 relative_extinction         3         4 10000 10000 0.000000e+00 0.000000e+00 #>  #> $t_tests$relative_fossilization #>                parameter Time_bin1 Time_bin2    n1    n2       p-value #> 1 relative_fossilization         1         2 10000 10000 5.666499e-179 #> 2 relative_fossilization         1         3 10000 10000 1.447373e-164 #> 3 relative_fossilization         1         4 10000 10000  1.030473e-05 #> 4 relative_fossilization         2         3 10000 10000  0.000000e+00 #> 5 relative_fossilization         2         4 10000 10000 4.449998e-129 #> 6 relative_fossilization         3         4 10000 10000 3.026156e-220 #>     p-value adj #> 1 1.133300e-178 #> 2 2.171060e-164 #> 3  1.030473e-05 #> 4  0.000000e+00 #> 5 5.339997e-129 #> 6 9.078469e-220 #>  #>  #> $mwu_tests #> $mwu_tests$net_speciation #>        parameter Time_bin1 Time_bin2    n1    n2       p-value   p-value adj #> 1 net_speciation         1         2 10000 10000  0.000000e+00  0.000000e+00 #> 2 net_speciation         1         3 10000 10000  0.000000e+00  0.000000e+00 #> 3 net_speciation         1         4 10000 10000  1.687839e-20  1.687839e-20 #> 4 net_speciation         2         3 10000 10000 7.102785e-263 8.523342e-263 #> 5 net_speciation         2         4 10000 10000  0.000000e+00  0.000000e+00 #> 6 net_speciation         3         4 10000 10000  0.000000e+00  0.000000e+00 #>  #> $mwu_tests$relative_extinction #>             parameter Time_bin1 Time_bin2    n1    n2       p-value #> 1 relative_extinction         1         2 10000 10000  0.000000e+00 #> 2 relative_extinction         1         3 10000 10000  0.000000e+00 #> 3 relative_extinction         1         4 10000 10000  0.000000e+00 #> 4 relative_extinction         2         3 10000 10000 3.308183e-304 #> 5 relative_extinction         2         4 10000 10000  0.000000e+00 #> 6 relative_extinction         3         4 10000 10000  0.000000e+00 #>     p-value adj #> 1  0.000000e+00 #> 2  0.000000e+00 #> 3  0.000000e+00 #> 4 3.308183e-304 #> 5  0.000000e+00 #> 6  0.000000e+00 #>  #> $mwu_tests$relative_fossilization #>                parameter Time_bin1 Time_bin2    n1    n2 p-value p-value adj #> 1 relative_fossilization         1         2 10000 10000       0           0 #> 2 relative_fossilization         1         3 10000 10000       0           0 #> 3 relative_fossilization         1         4 10000 10000       0           0 #> 4 relative_fossilization         2         3 10000 10000       0           0 #> 5 relative_fossilization         2         4 10000 10000       0           0 #> 6 relative_fossilization         3         4 10000 10000       0           0 #>  #>"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/characters.html","id":null,"dir":"Reference","previous_headings":"","what":"A morphological phylogenetic data matrix — characters","title":"A morphological phylogenetic data matrix — characters","text":"example dataset morphological characters early tetrapodomorphs Simões & Pierce (2021). type data used input get_gower_dist.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/characters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A morphological phylogenetic data matrix — characters","text":"","code":"data(\"characters\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/characters.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A morphological phylogenetic data matrix — characters","text":"data frame 178 observations (characters) 43 columns (taxa).","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/characters.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A morphological phylogenetic data matrix — characters","text":"Simões, T. R. S. E. Pierce (2021). Sustained High Rates Morphological Evolution Rise Tetrapods. Nature Ecology & Evolution 5: 1403–1414.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clock_reshape.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert clock rate tables from wide to long format — clock_reshape","title":"Convert clock rate tables from wide to long format — clock_reshape","text":"Converts clock rate tables, produced clockrate_summary imported back including clade names, wide long format.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clock_reshape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert clock rate tables from wide to long format — clock_reshape","text":"","code":"clock_reshape(rate_table)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clock_reshape.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert clock rate tables from wide to long format — clock_reshape","text":"rate_table data frame clock rates, output get_clockrate_table_MrBayes extra \"clade\" column.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clock_reshape.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert clock rate tables from wide to long format — clock_reshape","text":"function convert clock rate tables wide long format, new column \"clock\" containing clock partition rate estimate obtained factor. long format necessary downstream analyses selection strength (mode), similarly done FBD_reshape posterior parameter log files.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clock_reshape.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert clock rate tables from wide to long format — clock_reshape","text":"data frame containing single \"value\" column (rate values) one column \"clock\" variable (indicating clock partition rate values refers )","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clock_reshape.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert clock rate tables from wide to long format — clock_reshape","text":"","code":"# See vignette(\"rates-selection\") for how to use this # function as part of an analysis pipeline  ## The example dataset rate_table_clades_means3 already ## has clades and 3 clock rate columns: data(\"rate_table_clades_means3\") #> Warning: data set ‘rate_table_clades_means3’ not found  head(rate_table_clades_means3) #> Error in head(rate_table_clades_means3): object 'rate_table_clades_means3' not found  ## Reshape a clock rate table with clade names to long format rates_by_clade <- clock_reshape(rate_table_clades_means3) #> Error in startsWith(names(rate_table), \"rates\"): object 'rate_table_clades_means3' not found"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_dens_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot clock rate distributions — clockrate_dens_plot","title":"Plot clock rate distributions — clockrate_dens_plot","text":"Plots distribution density clock rates clock clade. input must \"clade\" column.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_dens_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot clock rate distributions — clockrate_dens_plot","text":"","code":"clockrate_dens_plot(rate_table, clock = NULL,                     stack = FALSE, nrow = 1,                     scales = \"fixed\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_dens_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot clock rate distributions — clockrate_dens_plot","text":"rate_table data frame clock rates, output get_clockrate_table_MrBayes extra \"clade\" column. clock clock rates plotted. unspecified, clocks plotted. stack Whether display stacked density plots (TRUE) overlapping density plots (FALSE). nrow plotting rates one clock, many rows filled plots. passed facet_wrap. scales plotting rates one clock, whether axis scales \"fixed\" (default) across clocks allowed vary (\"free\", \"free_x\", \"free_y\"). passed facet_wrap.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_dens_plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot clock rate distributions — clockrate_dens_plot","text":"user must manually add clades rate table produced get_clockrate_table_MrBayes can used function. can doen manually R, using graphical user interface editing data like DataEditR package, writing rate table spreadsheet reading back adding clades. example uses table clades added.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_dens_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot clock rate distributions — clockrate_dens_plot","text":"ggplot object, can modified using ggplot2 functions.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_dens_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot clock rate distributions — clockrate_dens_plot","text":"","code":"# See vignette(\"rates-selection\") for how to use this # function as part of an analysis pipeline  data(\"rate_table_clades_means3\") #> Warning: data set ‘rate_table_clades_means3’ not found  # Overlapping plots clockrate_dens_plot(rate_table_clades_means3, stack = FALSE,                     nrow = 1, scales = \"fixed\") #> Error in is.data.frame(rate_table): object 'rate_table_clades_means3' not found  # Stacked density for all three clocks, changing the color # palette to viridis using ggplot2 functions clockrate_dens_plot(rate_table_clades_means3,                     clock = 1:3, nrow = 1, stack = TRUE,                     scales = \"fixed\") +   ggplot2::scale_color_viridis_d() +   ggplot2::scale_fill_viridis_d() #> Error in is.data.frame(rate_table): object 'rate_table_clades_means3' not found"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_reg_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot regression lines between sets of rates — clockrate_reg_plot","title":"Plot regression lines between sets of rates — clockrate_reg_plot","text":"Displays scatterplot fits regression line one set clock rates another, optionally displaying Pearson correlation coefficient (r) R-squared values (R^2).","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_reg_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot regression lines between sets of rates — clockrate_reg_plot","text":"","code":"clockrate_reg_plot(rate_table, clock_x, clock_y,                    method = \"lm\", show_lm = TRUE,                    ...)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_reg_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot regression lines between sets of rates — clockrate_reg_plot","text":"rate_table table clock rates, output get_clockrate_table_MrBayes. clock_x, clock_y clock rates go x- y-axes, respectively. method method (function) used fit regression one clock . Check method argument geom_smooth function ggplot2 options. Default \"lm\" linear regression model. \"glm\" \"loess\" alternative options. show_lm Whether display Pearson correlation coefficient (r) R-squared values (R^2) two sets clock rates. ... arguments passed geom_smooth.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_reg_plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot regression lines between sets of rates — clockrate_reg_plot","text":"clockrate_reg_plot() can used multiple clocks present clock rate table. Unlike clockrate_summary clockrate_dens_plot, \"clade\" column required.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_reg_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot regression lines between sets of rates — clockrate_reg_plot","text":"ggplot object, can modified using ggplot2 functions.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_reg_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot regression lines between sets of rates — clockrate_reg_plot","text":"","code":"# See vignette(\"rates-selection\") for how to use this # function as part of an analysis pipeline  data(\"rate_table_clades_means3\") #> Warning: data set ‘rate_table_clades_means3’ not found  #Plot correlations between clocks 1 and 3 clockrate_reg_plot(rate_table_clades_means3,                    clock_x = 1, clock_y = 3) #> Error in is.data.frame(rate_table): object 'rate_table_clades_means3' not found  #Use arguments supplied to geom_smooth(): clockrate_reg_plot(rate_table_clades_means3,                    clock_x = 1, clock_y = 3,                    color = \"red\", se = FALSE) #> Error in is.data.frame(rate_table): object 'rate_table_clades_means3' not found"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute rate summary statistics across clades and clocks — clockrate_summary","title":"Compute rate summary statistics across clades and clocks — clockrate_summary","text":"Computes summary statistics clade /clock partition. input must \"clade\" column.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute rate summary statistics across clades and clocks — clockrate_summary","text":"","code":"clockrate_summary(rate_table, file = NULL, digits = 3)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute rate summary statistics across clades and clocks — clockrate_summary","text":"rate_table data frame clock rates, output get_clockrate_table_MrBayes extra \"clade\" column. file optional file path resulting table stored using write.csv. digits number digits round summary results . Default 3. See round.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_summary.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute rate summary statistics across clades and clocks — clockrate_summary","text":"user must manually add clades rate table produced get_clockrate_table_MrBayes can used function. can doen manually within R, using graphical user interface editing data like DataEditR package, writing rate table spreadsheet reading back adding clades. example uses table clades added.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute rate summary statistics across clades and clocks — clockrate_summary","text":"data frame containing row clade clock summary statistics (n, mean, standard deviation, minimum, 1st quartile, median, third quartile, maximum).","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/clockrate_summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute rate summary statistics across clades and clocks — clockrate_summary","text":"","code":"# See vignette(\"rates-selection\") for how to use this # function as part of an analysis pipeline  data(\"rate_table_clades_means3\") #> Warning: data set ‘rate_table_clades_means3’ not found  clockrate_summary(rate_table_clades_means3) #> Error in is.data.frame(rate_table): object 'rate_table_clades_means3' not found"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/cluster_to_nexus.html","id":null,"dir":"Reference","previous_headings":"","what":"Export character partitions to a Nexus file — cluster_to_nexus","title":"Export character partitions to a Nexus file — cluster_to_nexus","text":"Creates exports Nexus file list characters respective partitions inferred make_clusters function. contents can copied pasted directly Mr. Bayes commands block partitioned clock Bayesian inference analysis.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/cluster_to_nexus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export character partitions to a Nexus file — cluster_to_nexus","text":"","code":"cluster_to_nexus(cluster_df, file = NULL)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/cluster_to_nexus.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export character partitions to a Nexus file — cluster_to_nexus","text":"cluster_df cluster_df object; output call make_clusters. file path text file created containing partitioning information Nexus format. NULL (default), file written output returned string. \"\", text printed console. Passed directly file argument cat.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/cluster_to_nexus.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export character partitions to a Nexus file — cluster_to_nexus","text":"text string, returned invisibly file NULL. Use cat resulting output format correctly (.e., turn \"\\n\" line breaks).","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/cluster_to_nexus.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Export character partitions to a Nexus file — cluster_to_nexus","text":"","code":"# See vignette(\"char-part\") for how to use this # function as part of an analysis pipeline  # Load example phylogenetic data matrix data(\"characters\")  # Create distance matrix Dmatrix <- get_gower_dist(characters)  # Find optimal partitioning scheme using PAM under k=3 # partitions cluster_df <- make_clusters(Dmatrix, k = 3)  # Write to Nexus file and export to .txt file: file <- tempfile(fileext = \".txt\")  # You would set, e.g., # file <- \"path/to/file.txt\"  cluster_to_nexus(cluster_df, file = file)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/combine_log.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine and filter (.p) log files from Mr.Bayes — combine_log","title":"Combine and filter (.p) log files from Mr.Bayes — combine_log","text":"Imports parameter (.p) log files Mr. Bayes combines single data frame. Samples can dropped start log file (.e., discarded burn-) /downsampled reduce size output object.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/combine_log.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine and filter (.p) log files from Mr.Bayes — combine_log","text":"","code":"combine_log(path = \".\", burnin = 0.25, downsample = 10000)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/combine_log.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine and filter (.p) log files from Mr.Bayes — combine_log","text":"path path folder containing (.p) log files character vector log files read. burnin Either number proportion generations drop beginning log file. downsample Either number proportion generations user wants keep downsampling final (combined) log file. Generations dropped approximately equally-spaced intervals.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/combine_log.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Combine and filter (.p) log files from Mr.Bayes — combine_log","text":"combine_log() imports log files produced Mr.Bayes, ignoring first row file (contains ID number). files appended together, optionally removing burn-generations beginning /filtering throughout rest file. burnin greater 0, number propotion generations corresponding supplied value dropped beginning file read . example, setting burnin = .25 (default) drop first 25% generations file. downsample greater 0, file downsampled number proportion generations corresponding supplied value reached. example, downsample = 10000 generations (default) log files 4 independent runs (.e., 4 (.p) files), log file downsampled 2500 generations, final combined data frame contain 10000 samples, selected approximately equally spaced intervals original data. output can supplied get_pwt_rates FBD_reshape. latter convert log data frame wide long format, necessary used input downstream analyses using FBD_summary, FBD_dens_plot, FBD_normality_plot, FBD_tests1, FBD_tests2.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/combine_log.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine and filter (.p) log files from Mr.Bayes — combine_log","text":"data frame columns corresponding columns supplied log files rows containing sampled parameter values. Examples kind output produced can accessed using data(\"posterior1p\") data(\"posterior3p\").","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/combine_log.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine and filter (.p) log files from Mr.Bayes — combine_log","text":"","code":"# See vignette(\"fbd-params\") for how to use this # function as part of an analysis pipeline if (FALSE) { posterior <- combine_log(\"path/to/folder\", burnin = .25,                          downsample = 10000) }"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/drop.dummy.beast.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove dummy tip from beast summary trees, accounting for metadata on the tips — drop.dummy.beast","title":"Remove dummy tip from beast summary trees, accounting for metadata on the tips — drop.dummy.beast","text":"method designed remove dummy tip added offset trees postprocessing complete (instance summary tree built using TreeAnnotator).","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/drop.dummy.beast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove dummy tip from beast summary trees, accounting for metadata on the tips — drop.dummy.beast","text":"","code":"drop.dummy.beast(   tree.file,   output.file = NULL,   dummy.name = \"dummy\",   convert.heights = TRUE )"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/drop.dummy.beast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove dummy tip from beast summary trees, accounting for metadata on the tips — drop.dummy.beast","text":"tree.file path file containing tree dummy tip output.file path file write converted tree. NULL (default), tree simply returned. dummy.name name added dummy tip, default dummy. convert.heights whether height metadata converted height - offset (required plot e.g. HPD intervals correctly). Default TRUE.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/drop.dummy.beast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove dummy tip from beast summary trees, accounting for metadata on the tips — drop.dummy.beast","text":"list tree converted tree (treedata) ; offset age youngest tip final tree","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/drop.dummy.beast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove dummy tip from beast summary trees, accounting for metadata on the tips — drop.dummy.beast","text":"","code":"# Analyze the trees with dummy tips - for instance, calculate the MCC summary tree # Then remove the dummy tip from the MCC tree final_tree <- drop.dummy.beast(system.file(\"extdata\", \"ex_offset.MCC.tre\", package = \"EvoPhylo\"))"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/drop.dummy.mb.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove dummy tip from Mr. Bayes summary trees, accounting for metadata on the tips — drop.dummy.mb","title":"Remove dummy tip from Mr. Bayes summary trees, accounting for metadata on the tips — drop.dummy.mb","text":"method designed remove dummy tip added dataset running Mr. Bayes.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/drop.dummy.mb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove dummy tip from Mr. Bayes summary trees, accounting for metadata on the tips — drop.dummy.mb","text":"","code":"drop.dummy.mb(   tree.file,   output.file = NULL,   dummy.name = \"dummy\",   convert.ages = TRUE )"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/drop.dummy.mb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove dummy tip from Mr. Bayes summary trees, accounting for metadata on the tips — drop.dummy.mb","text":"tree.file path file containing tree dummy tip output.file path file write converted tree. NULL (default), tree simply returned. dummy.name name added dummy tip, default dummy. convert.ages whether height metadata converted height - offset (required plot e.g. HPD intervals correctly). Default TRUE.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/drop.dummy.mb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove dummy tip from Mr. Bayes summary trees, accounting for metadata on the tips — drop.dummy.mb","text":"list tree converted tree (treedata) ; offset age youngest tip final tree","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/drop.dummy.mb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove dummy tip from Mr. Bayes summary trees, accounting for metadata on the tips — drop.dummy.mb","text":"","code":"# Remove the dummy tip from the summary tree final_tree <- drop.dummy.mb(system.file(\"extdata\", \"tree_mb_dummy.tre\", package = \"EvoPhylo\"))"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_clockrate_table_BEAST2.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract evolutionary rates from Bayesian clock trees produced by BEAST2 — get_clockrate_table_BEAST2","title":"Extract evolutionary rates from Bayesian clock trees produced by BEAST2 — get_clockrate_table_BEAST2","text":"BEAST2 stores rates clock separate file. trees need loaded using treeio::read.beast.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_clockrate_table_BEAST2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract evolutionary rates from Bayesian clock trees produced by BEAST2 — get_clockrate_table_BEAST2","text":"","code":"get_clockrate_table_BEAST2(..., summary = \"median\", drop_dummy = NULL)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_clockrate_table_BEAST2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract evolutionary rates from Bayesian clock trees produced by BEAST2 — get_clockrate_table_BEAST2","text":"... treedata objects containing summary trees associated data rates separate clock. summary summary metric used rates. Currently supported: \"mean\" \"median\", default \"median\". drop_dummy NULL, drop dummy extant tip given label BEAST2 summary trees prior extracting clock rates (present). Default NULL.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_clockrate_table_BEAST2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract evolutionary rates from Bayesian clock trees produced by BEAST2 — get_clockrate_table_BEAST2","text":"data frame column containing node identifier (node) one column containing clock rates tree provided, order trees.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_clockrate_table_BEAST2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract evolutionary rates from Bayesian clock trees produced by BEAST2 — get_clockrate_table_BEAST2","text":"","code":"#Import all clock summary trees produced by BEAST2 from your local directory if (FALSE) { tree_clock1 <- treeio::read.beast(\"tree_file_clock1.tre\") tree_clock2 <- treeio::read.beast(\"tree_file_clock2.tre\") }  #Or use the example BEAST2 multiple clock trees that accompany EvoPhylo. data(tree_clock1) data(tree_clock2)  # obtain the rate table from BEAST2 trees rate_table <- get_clockrate_table_BEAST2(tree_clock1, tree_clock2, summary = \"mean\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_clockrate_table_MrBayes.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract evolutionary rates from a Bayesian clock tree produced by Mr. Bayes — get_clockrate_table_MrBayes","title":"Extract evolutionary rates from a Bayesian clock tree produced by Mr. Bayes — get_clockrate_table_MrBayes","text":"Extract evolutionary rate summary statistics node Bayesian clock summary tree produced Mr. Bayes stores data frame.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_clockrate_table_MrBayes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract evolutionary rates from a Bayesian clock tree produced by Mr. Bayes — get_clockrate_table_MrBayes","text":"","code":"get_clockrate_table_MrBayes(tree, summary = \"median\",                     drop_dummy = NULL)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_clockrate_table_MrBayes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract evolutionary rates from a Bayesian clock tree produced by Mr. Bayes — get_clockrate_table_MrBayes","text":"tree S4 class object type treedata; Bayesian clock tree imported using treeio::read.mrbayes Mr. Bayes summary trees. summary name rate summary. one \"mean\" \"median\". drop_dummy NULL, drop dummy extant tip given label Mr. Bayes summary tree prior extracting clock rates (present). Default NULL.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_clockrate_table_MrBayes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract evolutionary rates from a Bayesian clock tree produced by Mr. Bayes — get_clockrate_table_MrBayes","text":"data frame column containing node identifier (node) one column relaxed clock partition tree object containing clock rates.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_clockrate_table_MrBayes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract evolutionary rates from a Bayesian clock tree produced by Mr. Bayes — get_clockrate_table_MrBayes","text":"","code":"# See vignette(\"rates-selection\") for how to use this # function as part of an analysis pipeline  ## Import summary tree with three clock partitions produced by ## Mr. Bayes (.t or .tre files) from your local directory if (FALSE) { tree3p <- treeio::read.mrbayes(\"Tree3p.t\") }  #Or use the example Mr.Bayes multi-clock tree file (\\code{tree3p}) data(\"tree3p\")  # obtain the rate table from MrBayes tree rate_table <- get_clockrate_table_MrBayes(tree3p)  head(rate_table) #>   nodes   rates1   rates2   rates3 #> 1     1 0.927276 0.958621 0.984651 #> 2     2 1.039289 0.757550 0.899578 #> 3     3 1.151933 0.627024 0.795243 #> 4     4 1.189229 0.451265 0.693551 #> 5     5 1.188293 0.446332 0.693501 #> 6    46 1.175959 0.544381 0.747233"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_gower_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Gower distances between characters — get_gower_dist","title":"Compute Gower distances between characters — get_gower_dist","text":"Computes Gower distance characters phylogenetic data matrix.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_gower_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Gower distances between characters — get_gower_dist","text":"","code":"get_gower_dist(x, numeric = FALSE)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_gower_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Gower distances between characters — get_gower_dist","text":"x phylogenetic data matrix Nexus (.nex) format, data frame matrix format column character terminal taxa rows, read using ape::read.nexus.data. data include polymorphisms. numeric Whether treat values contained x numeric categorical. FALSE (default), features considered categorical; TRUE, considered numeric.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_gower_dist.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Compute Gower distances between characters — get_gower_dist","text":"function uses code adapted StatMatch::gower.dist() written Marcello D'Orazio.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_gower_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Gower distances between characters — get_gower_dist","text":"Gower distance matrix.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_gower_dist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Gower distances between characters — get_gower_dist","text":"","code":"# See vignette(\"char-part\") for how to use this # function as part of an analysis pipeline  # Load example phylogenetic data matrix data(\"characters\")  # Create distance matrix Dmatrix <- get_gower_dist(characters)  # Reading data matrix as numeric data Dmatrix <- get_gower_dist(characters, numeric = TRUE) #> Warning: NAs introduced by coercion; some values could not be converted to numbers."},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_pwt_rates.html","id":null,"dir":"Reference","previous_headings":"","what":"Conduct pairwise t-tests between node rates and clock base rate — get_pwt_rates","title":"Conduct pairwise t-tests between node rates and clock base rate — get_pwt_rates","text":"Produces data frame containing results 1-sample t-tests mean posterior clock rates node's absolute clock rate.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_pwt_rates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conduct pairwise t-tests between node rates and clock base rate — get_pwt_rates","text":"","code":"get_pwt_rates(rate_table, posterior)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_pwt_rates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conduct pairwise t-tests between node rates and clock base rate — get_pwt_rates","text":"rate_table data frame containing single \"value\" column (rate values) one column \"clock\" variable (indicating clock partition rate values refers ), output get_clockrate_table_MrBayes extra clade column added, followed clock_reshape. posterior data frame posterior parameter estimates including \"clockrate\" column indicating base clock rate estimate generation used pairwise t-tests. data frame can imported using combine_log (need reshape wide long). See posterior1p posterior3p datasets examples input file look.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_pwt_rates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Conduct pairwise t-tests between node rates and clock base rate — get_pwt_rates","text":"get_pwt_rates() first transforms relative clock rates absolute rate values node clock, multiplying mean posterior clock rate base value. , node clock, one-sample t-test performed null hypothesis mean posterior clockrates equal node clock's absolute clock rate.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_pwt_rates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conduct pairwise t-tests between node rates and clock base rate — get_pwt_rates","text":"long data frame one row per node per clock following columns: clade name clade, taken \"clade\" column rate_table nodes node number, taken \"node\" column rate_table clock clock partition number relative rate relative mean clock rate per node, taken \"rates\" columns rate_table absolute rate (mean) absolute mean clock rate per node; relative clock rate multiplied mean posterior clock rates null absolute clock rate used null value t-test p.value p-value test comparing mean ofthe posterior clockrates absolute clockrate","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_pwt_rates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Conduct pairwise t-tests between node rates and clock base rate — get_pwt_rates","text":"","code":"# See vignette(\"rates-selection\") for how to use this # function as part of an analysis pipeline  # Load example rate table and posterior data sets data(\"rate_table_clades_means3\") #> Warning: data set ‘rate_table_clades_means3’ not found data(\"posterior3p\")  get_pwt_rates(rate_table_clades_means3, posterior3p) #> Error in is.data.frame(rate_table): object 'rate_table_clades_means3' not found"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_sil_widths.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate silhouette widths index for various numbers of partitions — get_sil_widths","title":"Calculate silhouette widths index for various numbers of partitions — get_sil_widths","text":"Computes silhouette widths index several possible numbers clusters(partitions) k, determines well object falls within cluster compared clusters. best number clusters k one highest silhouette width.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_sil_widths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate silhouette widths index for various numbers of partitions — get_sil_widths","text":"","code":"get_sil_widths(dist_mat, max.k = 10)  # S3 method for sil_width_df plot(x, ...)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_sil_widths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate silhouette widths index for various numbers of partitions — get_sil_widths","text":"dist_mat Gower distance matrix, output call get_gower_dist. max.k maximum number clusters(partitions) search across. x sil_width_df object; output call get_sil_widths(). ... arguments passed ggplot2::geom_line control appearance plot.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_sil_widths.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate silhouette widths index for various numbers of partitions — get_sil_widths","text":"get_sil_widths calls cluster::pam supplied Gower distance matrix number clusters (partitions) max.k stores average silhouette widths across clustered characters. plot = TRUE, plot sillhouette widths number clusters produced, though can also produced seperately resulting data frame using plot.sil_width_df(). number clusters greatest silhouette width selected use final clustering specification.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_sil_widths.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate silhouette widths index for various numbers of partitions — get_sil_widths","text":"get_sil_widths(), produces data frame, inheriting class \"sil_width_df\", two columns: k number clusters, sil_width silhouette widths number clusters. plot = TRUE, output returned invisibly. plot() get_sil_widths() object, produces ggplot object can manipulated using ggplot2 syntax (e.g., change theme labels).","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/get_sil_widths.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate silhouette widths index for various numbers of partitions — get_sil_widths","text":"","code":"# See vignette(\"char-part\") for how to use this # function as part of an analysis pipeline  data(\"characters\")  #Reading example file as categorical data Dmatrix <- get_gower_dist(characters)  #Get silhouette widths for k=7 sw <- get_sil_widths(Dmatrix, max.k = 7)  sw #>   k sil_width #> 1 2 0.2340255 #> 2 3 0.2626128 #> 3 4 0.1863738 #> 4 5 0.1243595 #> 5 6 0.1205568 #> 6 7 0.1102649  plot(sw, color = \"red\", size =2)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/make_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate and plot character partitions — make_clusters","title":"Estimate and plot character partitions — make_clusters","text":"Determines cluster (partition) membership phylogenetic morphological characters supplied Gower distance matrix requested number clusters using partitioning around medoids (PAM, K-medoids). independently testing quality chosen partitioning scheme, users may also poduce graphic clustering (tSNEs), coloring data points according PAM clusters, verify PAM clustering results.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/make_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate and plot character partitions — make_clusters","text":"","code":"make_clusters(dist_mat, k, tsne = FALSE,               tsne_dim = 2, tsne_theta = 0,               ...)  # S3 method for cluster_df plot(x, seed = NA, nrow = 1,               ...)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/make_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate and plot character partitions — make_clusters","text":"dist_mat Gower distance matrix, output call get_gower_dist. k desired number clusters (character partitions), output get_sil_widths. tsne Whether perform Barnes-Hut t-distributed stochastic neighbor embedding (tSNE) produce multi-dimensional representation distance matrix using Rtsne::Rtsne. number dimensions controlled tsne_dim argument. See Details. Default FALSE. tsne_dim tsne = TRUE, number dimensions tSNE multidimensional scaling plots. passed dims argument Rtsne::Rtsne. Default 2. tsne_theta tsne = TRUE, parameter controlling speed/accuracy trade-(increase faster less accurate results). passed theta argument Rtsne::Rtsne. Default 0 exact tSNE. ... make_clusters(), arguments passed Rtsne::Rtsne tsne = TRUE. plot(), plotting cluster_df object, arguments passed ggrepel::geom_text_repel control display observation labels. x plot(), cluster_df object; output call make_clusters(). seed plot(), seed used control placement labels jittering points. Jittering occurs tsne = FALSE call make_clusters(). Using non-NA seed ensure replicability across uses. nrow plot(), tsne = TRUE call make_clusters() tsne_dim greater 2, number rows used display resulting 2-dimensional plots. Default 1 side--side plots.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/make_clusters.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate and plot character partitions — make_clusters","text":"make_clusters calls cluster::pam supplied Gower distance matrix specified number clusters determine cluster membership character. PAM analogous K-means, clusters centered around medoids instead centered around centroids, less prone impact outliers heterogeneous cluster sizes. PAM also advantage k-means utilizing Gower distance matrices instead Euclidean distance matrices . tsne = TRUE, Barnes-Hut t-distributed stochastic neighbor embedding used compute multi-dimensional embedding distance matrix, coloring data points according PAM-defined clusters, estimated function make_clusters. graphic clustering allows users independently test quality chosen partitioning scheme PAM, can help visualizing resulting clusters. Rtsne::Rtsne used . resulting dimensions included output; see Value . plot() plots morphological characters scatterplot points colored based cluster membership. tsne = TRUE call make_clusters(), x- y-axes correspond requested tSNE dimensions. 2 dimensions, several plots produced, one pair tSNE dimensions. displayed together using patchwork::plot_layout. tsne = FALSE, points arrange horizontally cluster membership randomly placed vertically.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/make_clusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate and plot character partitions — make_clusters","text":"data frame, inheriting class \"cluster_df\", row character number (character_number) cluster membership (cluster). tsne = TRUE, additional columns  included, one requested tSNE dimension, labeled tSNE_Dim1, tSNE_Dim2, etc., containing values dimensions computed using Rtsne(). pam fit resulting cluster::pam returned \"pam.fit\" attribute outut object.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/make_clusters.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Estimate and plot character partitions — make_clusters","text":"using plot() cluster_df object, warnings may appear ggrepel saying something along lines \"unlabeled data points (many overlaps). Consider increasing max.overlaps\". See ggrepel::geom_text_repel details; max.overlaps argument can supplied plot() increase maximum number element overlap plot. Alternatively, users can increase size plot exporting , increase plot area reduce number elements overlap. warning can generally ignored, though.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/make_clusters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate and plot character partitions — make_clusters","text":"","code":"# See vignette(\"char-part\") for how to use this # function as part of an analysis pipeline  data(\"characters\")  # Reading example file as categorical data Dmatrix <- get_gower_dist(characters)  sil_widths <- get_sil_widths(Dmatrix, max.k = 7)  sil_widths #>   k sil_width #> 1 2 0.2340255 #> 2 3 0.2626128 #> 3 4 0.1863738 #> 4 5 0.1243595 #> 5 6 0.1205568 #> 6 7 0.1102649 # 3 clusters yields the highest silhouette width  # Create clusters with PAM under k=3 partitions cluster_df <- make_clusters(Dmatrix, k = 3)  # Simple plot of clusters plot(cluster_df, seed = 12345) #> Warning: ggrepel: 5 unlabeled data points (too many overlaps). Consider increasing max.overlaps   # Create clusters with PAM under k=3 partitions and perform # tSNE (3 dimensions; default is 2) cluster_df_tsne <- make_clusters(Dmatrix, k = 3, tsne = TRUE,                                  tsne_dim = 2)  # Plot clusters, plots divided into 2 rows, and increasing # overlap of text labels (default = 10) plot(cluster_df_tsne, nrow = 2, max.overlaps = 20) #> Warning: ggrepel: 1 unlabeled data points (too many overlaps). Consider increasing max.overlaps"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages. — offset.to.dummy","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages. — offset.to.dummy","text":"method adds dummy tip present (t = 0) fully extinct trees offsets, order correct ages (otherwise recent tip assumed 0). workaround get proper ages trees tools TreeAnnotator.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages. — offset.to.dummy","text":"","code":"offset.to.dummy(trees.file, log.file, output.file = NULL, dummy.name = \"dummy\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages. — offset.to.dummy","text":"trees.file path BEAST2 output file containing posterior trees log.file path BEAST2 trace log file containing offset values output.file path file write converted trees. NULL (default), trees simply returned. dummy.name name added dummy tip, default dummy.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages. — offset.to.dummy","text":"list converted trees (treedata)","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages. — offset.to.dummy","text":"NB: metadata present tips discarded. want keep metadata (clock rate values), use offset..dummy.metadata instead.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages. — offset.to.dummy","text":"","code":"# Convert trees with offset to trees with dummy tip trees_file <- system.file(\"extdata\", \"ex_offset.trees\", package = \"EvoPhylo\") log_file <- system.file(\"extdata\", \"ex_offset.log\", package = \"EvoPhylo\") converted_trees <- offset.to.dummy.metadata(trees_file, log_file) #> [1] 364.0323  # Do something with the converted trees - for instance, calculate the MCC summary tree # Then remove the dummy tip from the MCC tree final_tree <- drop.dummy.beast(system.file(\"extdata\", \"ex_offset.MCC.tre\", package = \"EvoPhylo\"))"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages,\naccounting for possible metadata on the tips. — offset.to.dummy.metadata","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages,\naccounting for possible metadata on the tips. — offset.to.dummy.metadata","text":"method adds dummy tip present (t = 0) fully extinct trees offsets, order correct ages (otherwise recent tip assumed 0). workaround get proper ages trees tools TreeAnnotator.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages,\naccounting for possible metadata on the tips. — offset.to.dummy.metadata","text":"","code":"offset.to.dummy.metadata(   trees.file,   log.file,   output.file = NULL,   dummy.name = \"dummy\" )"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages,\naccounting for possible metadata on the tips. — offset.to.dummy.metadata","text":"trees.file path BEAST2 output file containing posterior trees log.file path BEAST2 trace log file containing offset values output.file path file write converted trees. NULL (default), trees simply returned. dummy.name name added dummy tip, default dummy.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages,\naccounting for possible metadata on the tips. — offset.to.dummy.metadata","text":"list converted trees (treedata)","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/offset.to.dummy.metadata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert trees produced by a BEAST2 FBD analysis with offset to trees with correct ages,\naccounting for possible metadata on the tips. — offset.to.dummy.metadata","text":"","code":"# Convert trees with offset to trees with dummy tip trees_file <- system.file(\"extdata\", \"ex_offset.trees\", package = \"EvoPhylo\") log_file <- system.file(\"extdata\", \"ex_offset.log\", package = \"EvoPhylo\") converted_trees <- offset.to.dummy.metadata(trees_file, log_file) #> [1] 364.0323  # Do something with the converted trees - for instance, calculate the MCC summary tree # Then remove the dummy tip from the MCC tree final_tree <- drop.dummy.beast(system.file(\"extdata\", \"ex_offset.MCC.tre\", package = \"EvoPhylo\"))"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/plot_treerates_sgn.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Bayesian evolutionary tree with rate thresholds for selection mode — plot_treerates_sgn","title":"Plot Bayesian evolutionary tree with rate thresholds for selection mode — plot_treerates_sgn","text":"Plots summary Bayesian evolutionary tree branches, according user-defined thresholds (units standard deviations) used infer strength mode selection.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/plot_treerates_sgn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Bayesian evolutionary tree with rate thresholds for selection mode — plot_treerates_sgn","text":"","code":"plot_treerates_sgn(tree, posterior, clock = 1,        summary = \"mean\", threshold = c(\"1 SD\", \"2 SD\"),        drop.dummyextant = TRUE,        low = \"blue\", mid = \"gray90\", high = \"red\",        branch_size = 2, tip_size = 2,        xlim = NULL, nbreaks = 10, geo_size=list(2, 3),        geo_skip = c(\"Quaternary\", \"Holocene\", \"Late Pleistocene\"))"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/plot_treerates_sgn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Bayesian evolutionary tree with rate thresholds for selection mode — plot_treerates_sgn","text":"tree tidytree object; output call treeio::read.mrbayes. posterior data frame posterior parameter estimates including \"clockrate\" column indicating base clock rate estimate generation used pairwise t-tests. data frame can imported using combine_log (need reshape wide long). See posterior1p posterior3p datasets examples input file look. clock clock number plot, (.e., number \"rate<clockmodel>Brlens{#}_mean\"). Ignored one clock available. summary rate summary plot, (.e., value \"rate<clockmodel>Brlens1_{summary}\"). \"mean\" \"median\" allowed. Default \"mean\". threshold vector threshold values. Default display thresholds ±1 relative standard deviation (SD) relative posterior clock rates. specified number standard deviations (e.g., \"1 SD\") confidence level confidence interal around mean relative posterior clockrate (e.g., \"95%\"). Multiple values allowed produce plot multiple thresholds. Set NULL omit thresholds. drop.dummyextant logical; whether drop \"Dummyextant\" tip (present) tree plotting tree. Default TRUE. low, mid, high Colors passed scale_color_steps2 control colors branches based thresholds exceeded. thresholds supplied, use mid control color tree. branch_size thickness lines form tree. tip_size font size tips tree. xlim x-axis limits. two negative numbers (though axis labels absolute value, .e., Ma). nbreaks number interval breaks geological timescale. geo_size font size labels geological scale. first value list() font size geological epochs second value geological periods. Passed directly size argument deeptime::coord_geo. geo_skip vector interval names indicating intervals labeled. Passed directly skip argument deeptime::coord_geo.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/plot_treerates_sgn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Bayesian evolutionary tree with rate thresholds for selection mode — plot_treerates_sgn","text":"Plots phylogentic tree contained tree using ggtree::ggtree. Branches undergoing accelerating evolutionary rates (e.g., >\"1 SD\", \"3 SD\", \"5 SD\" relative background rate) morphological partition suggest directional (positive) selection morphological partition branch tree. Branches undergoing decelerating evolutionary rates (e.g., <\"1 SD\", \"3 SD\", \"5 SD\" relative background rate) morphological partition suggest stabilizing selection morphological partition branch tree. details methods rationale, see Simões & Pierce (2021).","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/plot_treerates_sgn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Bayesian evolutionary tree with rate thresholds for selection mode — plot_treerates_sgn","text":"ggtree object, inherits ggplot.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/plot_treerates_sgn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plot Bayesian evolutionary tree with rate thresholds for selection mode — plot_treerates_sgn","text":"Simões, T. R. S. E. Pierce (2021). Sustained High Rates Morphological Evolution Rise Tetrapods. Nature Ecology & Evolution 5: 1403–1414.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/plot_treerates_sgn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Bayesian evolutionary tree with rate thresholds for selection mode — plot_treerates_sgn","text":"","code":"# See vignette(\"rates-selection\") for how to use this # function as part of an analysis pipeline  # Load example tree and posterior data(\"tree3p\") data(\"posterior3p\")  plot_treerates_sgn(   tree3p, posterior3p,   # show rates for clock partition 1   clock = 1,   # set summary stats to get from summary tree nodes   summary = \"mean\",   # set size for tree elements   branch_size = 1.5, tip_size = 3,   # set limits, breaks, and size for geological scale   xlim = c(-450, -260), nbreaks = 8, geo_size = list(3, 3),   # set rate threshold for selection strength   threshold = c(\"1 SD\", \"2 SD\")) #> [1] \"-2 SD\" \"-1 SD\" \"+1 SD\" \"+2 SD\" #> [1] 0.4965128 0.7482564 1.2517436 1.5034872"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/post_trees.html","id":null,"dir":"Reference","previous_headings":"","what":"Multiple phylogenetic clock trees — post_trees","title":"Multiple phylogenetic clock trees — post_trees","text":"Multiple clock Bayesian phylogenetic tree, imported S4 class object using treeio::read.beast().","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/post_trees.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multiple phylogenetic clock trees — post_trees","text":"","code":"data(\"post_trees\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/post_trees.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Multiple phylogenetic clock trees — post_trees","text":"tidytree object.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/post_trees.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multiple phylogenetic clock trees — post_trees","text":"Example tree file function write.beast.treedata.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/posterior1p.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior parameter samples (single clock) — posterior1p","title":"Posterior parameter samples (single clock) — posterior1p","text":"example dataset posterior parameter samples resulting clock-based Bayesian inference analysis using skyline fossilized birth–death process (FBD) tree model Mr. Bayes combining parameter (.p) files single data frame combine_log function. particular example produced analyzing data set single morphological partition Simões & Pierce (2021).","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/posterior1p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior parameter samples (single clock) — posterior1p","text":"","code":"data(\"posterior1p\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/posterior1p.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Posterior parameter samples (single clock) — posterior1p","text":"data frame 4000 observations several variables estimated generation analysis: Gen numeric vector generation number LnL numeric vector natural log likelihood cold chain LnPr numeric vector natural log likelihood priors TH numeric vector total tree height (sum branch durations, chronological units) TL numeric vector total tree length (sum branch lengths, accumulated substitutions/changes) prop_ancfossil numeric vector indicating proportion fossils recovered ancestors sigma numeric vector standard deviation lognormal distribution governing much rates vary across characters. net_speciation_1, net_speciation_2, net_speciation_3, net_speciation_4 numeric vector net speciation estimates time bin relative_extinction_1, relative_extinction_2, relative_extinction_3, relative_extinction_4 numeric vector relative extinction estimates time bin relative_fossilization_1, relative_fossilization_2, relative_fossilization_3, relative_fossilization_4 numeric vector relative fossilization estimates time bin tk02var numeric vector variance base clock rate clockrate numeric vector base clock rate","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/posterior1p.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Posterior parameter samples (single clock) — posterior1p","text":"Datasets like one can produced parameter log (.p) files using combine_log. number variables depends parameter set , clock analyses Mr. Bayes, typically include ones , possibly also including alpha, contains shape gamma distribution governing much rates vary across characters. using traditional FBD model rather skyline FBD model used produce dataset, one column net_speciation, relative_extinction relative_fossilization. using one morphological partition, different columns may present; see posterior3p example 3 partitions.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/posterior1p.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Posterior parameter samples (single clock) — posterior1p","text":"Simões, T. R. S. E. Pierce (2021). Sustained High Rates Morphological Evolution Rise Tetrapods. Nature Ecology & Evolution 5: 1403–1414.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/posterior3p.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior parameter samples (3 clock partions) — posterior3p","title":"Posterior parameter samples (3 clock partions) — posterior3p","text":"example dataset posterior parameter samples resulting clock-based Bayesian inference analysis using skyline fossilized birth–death process (FBD) tree model Mr. Bayes combining parameter (.p) files single data frame combine_log function. particular example produced analyzing data set three morphological partitions Simões & Pierce (2021).","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/posterior3p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior parameter samples (3 clock partions) — posterior3p","text":"","code":"data(\"posterior3p\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/posterior3p.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Posterior parameter samples (3 clock partions) — posterior3p","text":"data frame 4000 observations several variables estimated generation analysis. number variables depends parameter set , clock analyses Mr. Bayes, typically include following: Gen numeric vector generation number LnL numeric vector natural log likelihood cold chain LnPr numeric vector natural log likelihood priors TH.. numeric vector total tree height (sum branch durations, chronological units) TL.. numeric vector total tree length (sum branch lengths, accumulated substitutions/changes) prop_ancfossil.. numeric vector indicating proportion fossils recovered ancestors sigma.1., sigma.2., sigma.3. numeric vector standard deviation lognormal distribution governing much rates vary across characters data partition m.1., m.2., m.3. numeric vector rate multiplier parameter data partition net_speciation_1.., net_speciation_2.., net_speciation_3.., net_speciation_4.. numeric vector net speciation estimates time bin relative_extinction_1.., relative_extinction_2.., relative_extinction_3.., relative_extinction_4.. numeric vector relative extinction estimates time bin relative_fossilization_1.., relative_fossilization_2.., relative_fossilization_3.., relative_fossilization_4.. numeric vector relative fossilization estimates time bin tk02var.1., tk02var.2., tk02var.3. numeric vector variance base clock rate clock partition clockrate.. numeric vector base clock rate","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/posterior3p.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Posterior parameter samples (3 clock partions) — posterior3p","text":"Datasets like one can produced parameter log (.p) files using combine_log. number variables depends parameter set , clock analyses Mr. Bayes, typically include ones , possibly also including alpha partition, contains shape gamma distribution governing much rates vary across characters (shape distribution unlinked across partitions). using traditional FBD model rather skyline FBD model used produce dataset, one column net_speciation, relative_extinction relative_fossilization. using single morphological partition, different columns may present; see posterior1p example just one partition.","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/posterior3p.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Posterior parameter samples (3 clock partions) — posterior3p","text":"Simões, T. R. S. E. Pierce (2021). Sustained High Rates Morphological Evolution Rise Tetrapods. Nature Ecology & Evolution 5: 1403–1414.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/rate_table_clades_means1.html","id":null,"dir":"Reference","previous_headings":"","what":"Mean clock rates by node and clade (single clock) — rate_table_clades_means1","title":"Mean clock rates by node and clade (single clock) — rate_table_clades_means1","text":"data set containing mean clock rates tree 1 clock partition, output get_clockrate_table_MrBayes additional \"clade\" column added, required use clockrate_summary clockrate_dens_plot.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/rate_table_clades_means1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mean clock rates by node and clade (single clock) — rate_table_clades_means1","text":"","code":"data(\"rate_table_clades_means1\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/rate_table_clades_means1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mean clock rates by node and clade (single clock) — rate_table_clades_means1","text":"data frame 79 observations following 3 variables. clade character vector containing clade names corresponding node nodes numeric vector node numbers summary tree rates numeric vector containing mean posterior clock rate node","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/rate_table_clades_means1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mean clock rates by node and clade (single clock) — rate_table_clades_means1","text":"rate_table_clades_means1 created running get_clockrate_table_MrBayes(tree1p) adding \"clade\" column. can produced using following procedure: 1) Import tree file: 2) Produce clock rate table , instance, mean rate values branch tree: 3) Now, manually add clades using, e.g., Excel: 3.1) Manually edit rate_table.csv, adding \"clade\" column. introduces customized clade names individual nodes tree. 3.2) Save edited rate table different name differentiate original output (e.g., rate_table_clades_means.csv). 4) Read file back :","code":"data(\"tree1p\") rate_table <- get_clockrate_table_MrBayes(tree1p, summary = \"mean\") write.csv(rate_table, file = \"rate_table.csv\", row.names = FALSE) rate_table_clades_means1 <- read.csv(\"rate_table_clades_means.csv\") head(rate_table_clades_means1)"},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/rate_table_clades_means3.html","id":null,"dir":"Reference","previous_headings":"","what":"Mean clock rates by node and clade (3 clock partitions) — rate_table_clades_means3","title":"Mean clock rates by node and clade (3 clock partitions) — rate_table_clades_means3","text":"data set containing mean clock rates tree 3 clock partitions, output get_clockrate_table_MrBayes additional \"clade\" column added, required use clockrate_summary clockrate_dens_plot.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/rate_table_clades_means3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mean clock rates by node and clade (3 clock partitions) — rate_table_clades_means3","text":"","code":"data(\"rate_table_clades_means3\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/rate_table_clades_means3.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mean clock rates by node and clade (3 clock partitions) — rate_table_clades_means3","text":"data frame 79 observations following 5 variables. clade character vector containing clade names corresponding node nodes numeric vector node numbers summary tree rates1 numeric vector containing mean posterior clock rate node first partition rates2 numeric vector containing mean posterior clock rate node second partition rates3 numeric vector containing mean posterior clock rate node third partition","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/rate_table_clades_means3.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mean clock rates by node and clade (3 clock partitions) — rate_table_clades_means3","text":"rate_table_clades_means3 created running get_clockrate_table_MrBayes(tree3p) adding \"clade\" column. can produced using following procedure: 1) Import tree file: 2) Produce clock rate table , instance, mean rate values branch tree: 3) Now, manually add clades using, e.g., Excel: 3.1) Manually edit rate_table.csv, adding \"clade\" column. introduces customized clade names individual nodes tree. 3.2) Save edited rate table different name differentiate original output (e.g., rate_table_clades_means.csv). 4) Read file back :","code":"data(\"tree3p\") rate_table <- get_clockrate_table_MrBayes(tree3p, summary = \"mean\") write.csv(rate_table, file = \"rate_table.csv\", row.names = FALSE) rate_table_clades_means3 <- read.csv(\"rate_table_clades_means.csv\") head(rate_table_clades_means3)"},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree1p.html","id":null,"dir":"Reference","previous_headings":"","what":"Phylogenetic tree with a single clock partition — tree1p","title":"Phylogenetic tree with a single clock partition — tree1p","text":"clock Bayesian phylogenetic tree, imported S4 class object using treeio::read.mrbayes().","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree1p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phylogenetic tree with a single clock partition — tree1p","text":"","code":"data(\"tree1p\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree1p.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Phylogenetic tree with a single clock partition — tree1p","text":"tidytree object.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree1p.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Phylogenetic tree with a single clock partition — tree1p","text":"example tree file produced analyzing data set single morphological partition Simões & Pierce (2021).","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree1p.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Phylogenetic tree with a single clock partition — tree1p","text":"Simões, T. R. S. E. Pierce (2021). Sustained High Rates Morphological Evolution Rise Tetrapods. Nature Ecology & Evolution 5: 1403–1414.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree3p.html","id":null,"dir":"Reference","previous_headings":"","what":"Phylogenetic tree with 3 clock partitions — tree3p","title":"Phylogenetic tree with 3 clock partitions — tree3p","text":"clock Bayesian phylogenetic tree, imported S4 class object using treeio::read.mrbayes().","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree3p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phylogenetic tree with 3 clock partitions — tree3p","text":"","code":"data(\"tree3p\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree3p.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Phylogenetic tree with 3 clock partitions — tree3p","text":"tidytree object.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree3p.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Phylogenetic tree with 3 clock partitions — tree3p","text":"example tree file produced analyzing data set 3 morphological clock partitions Simões & Pierce (2021).","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree3p.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Phylogenetic tree with 3 clock partitions — tree3p","text":"Simões, T. R. S. E. Pierce (2021). Sustained High Rates Morphological Evolution Rise Tetrapods. Nature Ecology & Evolution 5: 1403–1414.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree_clock1.html","id":null,"dir":"Reference","previous_headings":"","what":"BEAST2 phylogenetic tree with clock rates from partition 1 — tree_clock1","title":"BEAST2 phylogenetic tree with clock rates from partition 1 — tree_clock1","text":"clock Bayesian phylogenetic tree clock rates single clock partition (partition 1 ), imported S4 class object using treeio::read.beast().","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree_clock1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BEAST2 phylogenetic tree with clock rates from partition 1 — tree_clock1","text":"","code":"data(\"tree_clock1\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree_clock1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"BEAST2 phylogenetic tree with clock rates from partition 1 — tree_clock1","text":"tidytree object.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree_clock1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"BEAST2 phylogenetic tree with clock rates from partition 1 — tree_clock1","text":"example tree file produced analyzing data set single morphological partition ","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree_clock2.html","id":null,"dir":"Reference","previous_headings":"","what":"BEAST2 phylogenetic tree with clock rates from partition 2 — tree_clock2","title":"BEAST2 phylogenetic tree with clock rates from partition 2 — tree_clock2","text":"clock Bayesian phylogenetic tree clock rates single clock partition (partition 2 ), imported S4 class object using treeio::read.beast().","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree_clock2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BEAST2 phylogenetic tree with clock rates from partition 2 — tree_clock2","text":"","code":"data(\"tree_clock2\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree_clock2.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"BEAST2 phylogenetic tree with clock rates from partition 2 — tree_clock2","text":"tidytree object.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/tree_clock2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"BEAST2 phylogenetic tree with clock rates from partition 2 — tree_clock2","text":"example tree file produced analyzing data set single morphological partition ","code":""},{"path":[]},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/write.beast.treedata.html","id":null,"dir":"Reference","previous_headings":"","what":"Export multiple treedata objects (S4 class tree files) to BEAST NEXUS file — write.beast.treedata","title":"Export multiple treedata objects (S4 class tree files) to BEAST NEXUS file — write.beast.treedata","text":"function adopted modified treeio::write.beast export list trees instead single tree.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/write.beast.treedata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export multiple treedata objects (S4 class tree files) to BEAST NEXUS file — write.beast.treedata","text":"","code":"write.beast.treedata(treedata, file = \"\",                     translate = TRUE, tree.name = \"STATE\")"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/write.beast.treedata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export multiple treedata objects (S4 class tree files) to BEAST NEXUS file — write.beast.treedata","text":"treedata S4 class object type treedata containing multiple trees; e.g. Bayesian clock tree distribution imported using treeio::read.beast treeio::read.mrbayes. file Output file. file = \"\", prints output content screen. translate Whether translate taxa labels. tree.name Name trees, default \"STATE\".","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/write.beast.treedata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export multiple treedata objects (S4 class tree files) to BEAST NEXUS file — write.beast.treedata","text":"Writes object type treedata containing multiple trees file file content screen","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/write.beast.treedata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Export multiple treedata objects (S4 class tree files) to BEAST NEXUS file — write.beast.treedata","text":"","code":"#Load file with multiple trees if (FALSE) { trees_file = system.file(\"extdata\", \"ex_offset.trees\", package = \"EvoPhylo\") posterior_trees_offset = treeio::read.beast(trees_file)  #Write multiple trees to screen write.beast.treedata(posterior_trees_offset) }"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/write_partitioned_alignments.html","id":null,"dir":"Reference","previous_headings":"","what":"Write character partitions as separate Nexus files (for use in BEAUti) — write_partitioned_alignments","title":"Write character partitions as separate Nexus files (for use in BEAUti) — write_partitioned_alignments","text":"Write character partitions separate Nexus files (use BEAUti)","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/write_partitioned_alignments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write character partitions as separate Nexus files (for use in BEAUti) — write_partitioned_alignments","text":"","code":"write_partitioned_alignments(x, cluster_df, file)"},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/write_partitioned_alignments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write character partitions as separate Nexus files (for use in BEAUti) — write_partitioned_alignments","text":"x character data matrix Nexus file (.nex) data frame (taxa rows characters columns) read directly local directory cluster_df cluster partitions outputted make.clusters file path save alignments. file = \"example.nex\", alignments saved files \"example_part1.nex\", \"example_part2.nex\", etc.","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/write_partitioned_alignments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write character partitions as separate Nexus files (for use in BEAUti) — write_partitioned_alignments","text":"return value","code":""},{"path":"https://tiago-simoes.github.io/EvoPhylo/reference/write_partitioned_alignments.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write character partitions as separate Nexus files (for use in BEAUti) — write_partitioned_alignments","text":"","code":"# Load example phylogenetic data matrix data(\"characters\")  # Create distance matrix Dmatrix <- get_gower_dist(characters)  # Find optimal partitioning scheme using PAM under k=3 partitions cluster_df <- make_clusters(Dmatrix, k = 3)  # Write to Nexus files if (FALSE) write_partitioned_alignments(x, cluster_df, \"example.nex\")"}]
